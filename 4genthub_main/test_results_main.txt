
üß™ Starting 4genthub Test Suite
üõ°Ô∏è  Test data isolation enabled
üßπ Automatic cleanup configured
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.0, pluggy-1.6.0 -- /home/daihungpham/__projects__/agentic-project/4genthub_main/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests
configfile: pytest.ini
plugins: report-0.2.1, xdist-3.7.0, timeout-2.4.0, env-1.1.5, cov-6.2.1, anyio-4.9.0, httpx-0.35.0, flakefinder-1.1.0, asyncio-1.0.0
timeout: 60.0s
timeout method: signal
timeout func_only: False
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 6700 items / 3 skipped

src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_create_intelligent_plan_basic PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_plan_contains_expected_patterns PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_agent_assignment PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_subtask_generation PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_dependency_generation PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_effort_estimation PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_parallel_execution_groups PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_plan_validation PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_confidence_score_calculation PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_risk_identification PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_technical_considerations PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_empty_requirements_handling PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_task_type_determination PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_execute_plan_without_facade PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_execute_plan_with_facade PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_phase_ordering PASSED [  0%]
src/tests/ai_task_planning/application/services/ai_planning_service_test.py::TestAITaskPlanningService::test_workload_distribution PASSED [  0%]
src/tests/ai_task_planning/application/test_application_init.py::TestAITaskPlanningApplicationInit::test_application_package_import PASSED [  0%]
src/tests/ai_task_planning/application/test_application_init.py::TestAITaskPlanningApplicationInit::test_application_package_structure PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestRequirementItem::test_create_requirement_item PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestRequirementItem::test_requirement_item_with_full_details PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_create_basic_planning_request PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_add_requirement PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_add_code_reference PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_estimate_overall_complexity_empty PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_estimate_overall_complexity_with_estimates PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_estimate_overall_complexity_heuristics PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_planning_request_with_full_context PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_to_dict_serialization PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_from_dict_deserialization PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_complexity_level_enum_values PASSED [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py::TestPlanningRequest::test_planning_context_enum_values PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestAgentAssignment::test_create_basic_agent_assignment PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestAgentAssignment::test_agent_assignment_with_support PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestAgentAssignment::test_agent_assignment_to_dict PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_create_basic_planned_task PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_planned_task_with_full_details PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_add_subtask PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_can_run_in_parallel_same_agent PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_can_run_in_parallel_file_conflict PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_can_run_in_parallel_compatible_phases PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_to_mcp_task_request PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestPlannedTask::test_to_dict_serialization PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_create_basic_task_plan PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_add_task_to_plan PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_add_dependency PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_get_task_by_id PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_get_root_and_subtasks PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_find_parallel_execution_groups PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_validate_plan_circular_dependency PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_validate_plan_missing_task_reference PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_validate_plan_unassigned_tasks PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_calculate_critical_path_simple PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_to_dict_serialization PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_task_type_enum_values PASSED [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py::TestTaskPlan::test_execution_phase_enum_values PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_detect_crud_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_detect_authentication_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_detect_multiple_patterns PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_complexity_analysis PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_ui_component_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_database_schema_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_performance_requirement_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_security_requirement_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_bug_fix_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_deployment_pattern PASSED [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_risk_identification PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_dependency_inference PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_effort_estimation PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_analyze_requirements_batch PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_generate_planning_insights PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_technical_considerations PASSED [  1%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py::TestRequirementAnalyzer::test_empty_requirement_handling PASSED [  1%]
src/tests/ai_task_planning/domain/services/test_services_init.py::TestAITaskPlanningDomainServicesInit::test_services_package_import PASSED [  1%]
src/tests/ai_task_planning/domain/services/test_services_init.py::TestAITaskPlanningDomainServicesInit::test_services_package_structure PASSED [  1%]
src/tests/ai_task_planning/domain/test_domain_init.py::TestAITaskPlanningDomainInit::test_domain_package_import PASSED [  1%]
src/tests/ai_task_planning/domain/test_domain_init.py::TestAITaskPlanningDomainInit::test_domain_package_structure PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_missing_required_params PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_with_comma_separated_requirements PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_with_json_requirements PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_with_invalid_json PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_with_invalid_deadline PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_create_ai_plan_exception_handling PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_analyze_requirements_basic PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_analyze_requirements_json_format PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_analyze_requirements_missing_param PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_estimate_effort_basic PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_estimate_effort_with_breakdown PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_suggest_agents_basic PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_suggest_agents_with_filter PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_get_plan_status PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_validate_plan PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_generate_recommendations PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_calculate_estimation_confidence PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_estimate_agent_workload PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestAITaskPlanningMCPController::test_identify_specialization_needs PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_create_ai_plan_with_empty_requirements PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_create_ai_plan_with_malformed_requirements_list PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_analyze_requirements_with_invalid_json PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_suggest_agents_empty_available_list PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_estimate_effort_extreme_values PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_create_ai_plan_service_timeout PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestEdgeCases::test_identify_specialization_needs_comprehensive PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestComplexIntegrationScenarios::test_create_plan_with_all_optional_parameters PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestComplexIntegrationScenarios::test_parallel_requirement_analysis PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestComplexIntegrationScenarios::test_recommendation_generation_edge_cases PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestComplexIntegrationScenarios::test_validate_plan_placeholder_response PASSED [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py::TestComplexIntegrationScenarios::test_get_plan_status_placeholder_response PASSED [  1%]
src/tests/ai_task_planning/interface/test_interface_init.py::TestAITaskPlanningInterfaceInit::test_interface_package_import PASSED [  1%]
src/tests/ai_task_planning/interface/test_interface_init.py::TestAITaskPlanningInterfaceInit::test_interface_package_structure PASSED [  1%]
src/tests/ai_task_planning/test_ai_planning_init.py::TestAITaskPlanningPackageInit::test_package_import PASSED [  1%]
src/tests/ai_task_planning/test_ai_planning_init.py::TestAITaskPlanningPackageInit::test_package_structure PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_enhanced_sign_up_request_valid PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_enhanced_sign_up_request_minimal PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_password_reset_request PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_verify_email_request PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_reset_password_request PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestRequestModels::test_resend_verification_request PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestResponseModels::test_enhanced_auth_response_success PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestResponseModels::test_enhanced_auth_response_with_email_verification PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestResponseModels::test_enhanced_auth_response_failure PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestUtilityFunctions::test_get_client_info_full PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestUtilityFunctions::test_get_client_info_no_forwarded PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestUtilityFunctions::test_get_client_info_no_client PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestUtilityFunctions::test_get_client_info_empty_headers PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestModelValidation::test_email_validation PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestModelValidation::test_password_min_length PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestModelValidation::test_optional_fields_default PASSED [  1%]
src/tests/auth/api/enhanced_auth_endpoints_test.py::TestModelValidation::test_response_datetime_serialization PASSED [  1%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_valid_token PASSED [  1%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_user_id_instead_of_sub PASSED [  1%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_without_jwt_secret PASSED [  1%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_expired_token PASSED [  1%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_invalid_token PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_missing_user_id PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_expired_timestamp PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_with_minimal_payload PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetCurrentUser::test_get_current_user_general_exception PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetOptionalCurrentUser::test_get_optional_user_with_no_credentials PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetOptionalCurrentUser::test_get_optional_user_with_valid_credentials PASSED [  2%]
src/tests/auth/dependencies_test.py::TestGetOptionalCurrentUser::test_get_optional_user_with_invalid_credentials PASSED [  2%]
src/tests/auth/dependencies_test.py::TestJWTConfiguration::test_jwt_algorithm_default PASSED [  2%]
src/tests/auth/dependencies_test.py::TestJWTConfiguration::test_jwt_algorithm_from_env PASSED [  2%]
src/tests/auth/dependencies_test.py::TestJWTConfiguration::test_jwt_secret_key_warning_when_not_set PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_valid PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_expired PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_invalid_signature PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_auth_disabled PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_not_hook_token PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_invalid_format PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthValidator::test_validate_hook_token_unexpected_error PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthDependencies::test_get_hook_authenticated_user_success PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthDependencies::test_get_hook_authenticated_user_no_credentials PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookAuthDependencies::test_get_hook_authenticated_user_invalid_token PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_python PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_aiohttp PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_httpx PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_claude_hook PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_mcp_client PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_browser PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_no_user_agent PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestHookDetection::test_is_hook_request_case_insensitive PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestMcpJsonToken::test_get_token_from_mcp_json_success PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestMcpJsonToken::test_get_token_from_mcp_json_no_file PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestMcpJsonToken::test_get_token_from_mcp_json_invalid_structure PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestMcpJsonToken::test_get_token_from_mcp_json_no_bearer_prefix PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestTokenCreation::test_create_hook_token_default PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestTokenCreation::test_create_hook_token_custom_user PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestTokenCreation::test_create_hook_token_custom_expiry PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestTokenCreation::test_create_hook_token_unique_jti PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestIntegration::test_round_trip_token_creation_and_validation PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestIntegration::test_full_auth_flow PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestEnvironmentVariables::test_hook_jwt_algorithm_default PASSED [  2%]
src/tests/auth/hook_auth_test.py::TestEnvironmentVariables::test_hook_jwt_secret_required PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailToken::test_email_token_creation PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenModel::test_model_table_name PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenModel::test_model_columns PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_repository_initialization_default_url PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_repository_initialization_custom_url PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_save_token_success PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_save_token_failure PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_exists PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_not_exists PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_database_error PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_tokens_by_email PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_tokens_by_email_include_used PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_mark_token_used_success PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_mark_token_used_custom_time PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_mark_token_used_failure PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_delete_token_success PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_delete_token_not_exists PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_delete_token_failure PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_cleanup_expired_tokens PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_cleanup_expired_tokens_failure PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_success PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_not_found PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_already_used PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_expired PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_no_mark_used PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_validate_token_database_error PASSED [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_stats PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_stats_empty_db PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_get_token_stats_database_error PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_model_to_token_conversion PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_model_to_token_invalid_json PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_token_to_model_conversion PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEmailTokenRepository::test_token_to_model_invalid_metadata PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestGlobalRepository::test_get_email_token_repository_singleton PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestGlobalRepository::test_get_email_token_repository_type PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEdgeCases::test_timezone_handling_naive_datetime PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEdgeCases::test_empty_email_handling PASSED [  3%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py::TestEdgeCases::test_large_metadata_handling PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_login_request_model PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_register_request_model_valid PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_register_request_password_validation PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_register_request_email_validation PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_register_request_username_validation PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_register_response_model PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestDataModels::test_login_response_model PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_get_keycloak_admin_token_client_credentials_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_get_keycloak_admin_token_fallback_to_admin PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_get_keycloak_admin_token_failure PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_cleanup_incomplete_account_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_cleanup_incomplete_account_protected PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestHelperFunctions::test_setup_user_roles_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_invalid_credentials PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_account_not_fully_setup PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_invalid_scope_retry PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_connection_error PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_supabase_not_implemented PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLoginEndpoint::test_login_test_mode PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_email_verification_required PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_invalid_password FAILED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_invalid_email FAILED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_user_already_exists PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_with_cleanup_and_retry PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_supabase_not_implemented PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_test_mode PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRefreshTokenEndpoint::test_refresh_token_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRefreshTokenEndpoint::test_refresh_token_invalid PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRefreshTokenEndpoint::test_refresh_token_connection_error PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestRefreshTokenEndpoint::test_refresh_token_test_mode PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLogoutEndpoint::test_logout_success PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLogoutEndpoint::test_logout_connection_error PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestLogoutEndpoint::test_logout_without_token PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_get_provider PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_verify_auth PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_get_password_requirements PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_validate_password_strong PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_validate_password_weak PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestUtilityEndpoints::test_registration_success_handler PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestEdgeCasesAndErrorHandling::test_register_empty_username PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestEdgeCasesAndErrorHandling::test_register_keycloak_bad_request PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestEdgeCasesAndErrorHandling::test_login_keycloak_generic_error PASSED [  3%]
src/tests/auth/interface/auth_endpoints_test.py::TestEdgeCasesAndErrorHandling::test_validate_password_with_all_requirements PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakJWKSClient::test_get_keycloak_jwks_client_not_configured PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakJWKSClient::test_get_keycloak_jwks_client_creates_new PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakJWKSClient::test_get_keycloak_jwks_client_correct_url PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestUniversalUserAuthentication::test_get_current_user_keycloak_token PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestUniversalUserAuthentication::test_get_current_user_local_token PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestUniversalUserAuthentication::test_get_current_user_decode_error PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_success PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_not_configured PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_no_jwks_client PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_expired PASSED [  3%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_missing_sub PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestKeycloakTokenValidation::test_validate_keycloak_token_no_email PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_success PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_no_secret PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_expired PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_invalid PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_missing_user_id PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_user_id_fallback PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_minimal PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestLocalTokenValidation::test_validate_local_token_expired_by_timestamp PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestIntegration::test_keycloak_to_local_fallback PASSED [  4%]
src/tests/auth/keycloak_dependencies_test.py::TestIntegration::test_clock_skew_tolerance FAILED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_initialization_with_params PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_initialization_from_env PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_initialization_missing_url PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_url_construction PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_jwks_client_creation PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_get_oidc_configuration_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_get_oidc_configuration_cached PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_get_oidc_configuration_cache_expired PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_validate_token_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_validate_token_expired PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_validate_token_invalid PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_validate_token_missing_sub PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_get_user_info_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_get_user_info_failure PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_exchange_token_password_grant PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_exchange_token_refresh_grant PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_exchange_token_auth_code_grant PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_exchange_token_no_credentials PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_exchange_token_http_error PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_logout_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_logout_failure PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakAuthProvider::test_close PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_authenticate_mcp_request_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_authenticate_mcp_request_no_header PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_authenticate_mcp_request_invalid_format PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_authenticate_mcp_request_invalid_token PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_mcp_permissions_mapping_admin PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_mcp_permissions_mapping_user PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_mcp_permissions_mapping_default PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_create_mcp_token_success PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_create_mcp_token_invalid_keycloak PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestKeycloakMCPAuth::test_create_mcp_token_default_scopes PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestSingletonFunctions::test_get_keycloak_provider_singleton PASSED [  4%]
src/tests/auth/keycloak_integration_test.py::TestSingletonFunctions::test_get_keycloak_mcp_auth PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_success PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_no_jwt_secret PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_invalid_token PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_expired_token PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_missing_user_id PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_user_id_fallback PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_minimal_payload PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_with_auth_provider PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_expired_by_timestamp PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_exception_handling PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetCurrentMCPUser::test_get_current_mcp_user_http_exception_passthrough PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetOptionalMCPUser::test_get_optional_mcp_user_with_valid_credentials PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetOptionalMCPUser::test_get_optional_mcp_user_no_credentials PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetOptionalMCPUser::test_get_optional_mcp_user_invalid_credentials PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetOptionalMCPUser::test_get_optional_mcp_user_expired_token PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestGetOptionalMCPUser::test_get_optional_mcp_user_exception_handling PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestIntegration::test_full_authentication_flow PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestIntegration::test_authentication_with_different_algorithms PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestConstants::test_frontend_jwt_algorithm PASSED [  4%]
src/tests/auth/mcp_dependencies_test.py::TestConstants::test_frontend_jwt_secret_from_env PASSED [  4%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py::TestDatabaseConnectionAnalysis::test_database_config_analysis PASSED [  4%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py::TestDatabaseConnectionAnalysis::test_repository_analysis PASSED [  5%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py::TestDatabaseConnectionAnalysis::test_root_cause_analysis PASSED [  5%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py::TestDatabaseConnectionAnalysis::test_fix_recommendations PASSED [  5%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py::TestDatabaseConnectionAnalysis::test_complete_analysis_report PASSED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_current_environment_configuration FAILED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_fix_with_database_url FAILED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_fix_with_supabase_database_url FAILED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_component_construction_fallback FAILED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_database_config_with_fix FAILED [  5%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_complete_fix_validation FAILED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_initialization_enabled PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_initialization_disabled PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_auth_disabled PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_valid PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_invalid PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_insufficient_roles PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_client_specific_roles PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_mcp_token_exception_handling PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_build_mcp_permissions_admin PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_build_mcp_permissions_developer PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_build_mcp_permissions_user PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_build_mcp_permissions_multiple_roles PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_get_allowed_tools_admin PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_get_allowed_tools_developer PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_get_allowed_tools_regular_user PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_get_allowed_tools_combined_roles PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_get_current_user PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_mcp_permission_decorator_success PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_mcp_permission_decorator_wildcard PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_mcp_permission_decorator_denied PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_mcp_permission_decorator_no_user PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_tool_access_decorator_success PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_tool_access_decorator_wildcard PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_require_tool_access_decorator_denied PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_create_mcp_session PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_tool_request_allowed PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_tool_request_admin_wildcard PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_tool_request_denied PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestMCPKeycloakAuth::test_validate_tool_request_parameter_validation PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestGlobalFunctions::test_get_mcp_user_dependency PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestGlobalFunctions::test_require_mcp_auth_decorator_enabled PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestGlobalFunctions::test_require_mcp_auth_decorator_disabled PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestIntegration::test_full_authentication_flow PASSED [  5%]
src/tests/auth/mcp_keycloak_auth_test.py::TestIntegration::test_decorator_integration PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_dispatch_no_auth PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_dispatch_with_auth PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_dispatch_mcp_endpoint PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_dispatch_error_handling PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_capture_auth_context_from_request_state PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_capture_auth_context_no_request_state PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_capture_auth_context_error PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_clear_auth_context PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_current_user_id PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_current_user_email PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_current_auth_method PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_current_auth_info PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_is_request_authenticated PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_authentication_context PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_authentication_context_error PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_get_current_user_context_backward_compat PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_context_var_error_handling PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_create_request_context_middleware PASSED [  5%]
src/tests/auth/middleware/request_context_middleware_test.py::TestRequestContextMiddleware::test_dispatch_asgi_scope_edge_cases PASSED [  5%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_table_name PASSED [  5%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_columns PASSED [  5%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_creation PASSED [  5%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_defaults PASSED [  5%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_basic PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_with_token PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_include_token_no_value PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_datetime_formatting PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_with_last_used PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_none_datetimes PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_to_dict_empty_scopes PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_column_constraints PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_id_format PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_scopes_array PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_rate_limit_tracking PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiToken::test_api_token_active_status PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_with_very_long_name PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_with_many_scopes PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_zero_rate_limit PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_high_usage_count PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_past_expiration PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenEdgeCases::test_api_token_special_characters_in_name PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenBase::test_base_class_inheritance PASSED [  6%]
src/tests/auth/models/api_token_test.py::TestApiTokenBase::test_base_metadata PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountConfig::test_config_initialization PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountConfig::test_config_default_scopes PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceToken::test_token_initialization PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceToken::test_token_expiry_calculation PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceToken::test_token_is_expired PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceToken::test_seconds_until_expiry PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_initialization_with_config PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_initialization_from_env PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_validate_config_missing_fields PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_config_url_trailing_slash PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_jwks_client_creation PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_authenticate_success PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_authenticate_cached_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_authenticate_force_refresh PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_authenticate_failure PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_authenticate_exception PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_valid_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_valid_token_none PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_validate_token_valid PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_validate_token_wrong_type PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_validate_token_wrong_client PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_validate_token_expired PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_service_info_success PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_service_info_no_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_auth_headers_with_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_auth_headers_no_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_get_auth_headers_expired_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_health_check PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_health_check_no_token PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_token_refresh_loop PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_context_manager PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_close PASSED [  6%]
src/tests/auth/service_account_test.py::TestServiceAccountAuth::test_rate_limiting PASSED [  6%]
src/tests/auth/service_account_test.py::TestGlobalFunctions::test_get_service_account_auth_singleton PASSED [  6%]
src/tests/auth/service_account_test.py::TestGlobalFunctions::test_authenticate_service_request_valid PASSED [  6%]
src/tests/auth/service_account_test.py::TestGlobalFunctions::test_authenticate_service_request_no_header PASSED [  6%]
src/tests/auth/service_account_test.py::TestGlobalFunctions::test_authenticate_service_request_invalid_format PASSED [  6%]
src/tests/auth/service_account_test.py::TestGlobalFunctions::test_authenticate_service_request_invalid_token PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_controller_initialization PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_health_check_success PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_health_check_without_details PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_health_check_with_user_id PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_health_check_exception_handling PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_response_formatting_success PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_response_formatting_error PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_initialization_logging PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_error_logging PASSED [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_register_tools_method_exists PASSED [  7%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_health_check_method_exists PASSED [  7%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_no_deprecated_methods PASSED [  7%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py::TestConnectionMCPController::test_only_health_check_functionality PASSED [  7%]
src/tests/connection_management/test_secure_health_check.py::TestSecureHealthCheck::test_environment_info_doesnt_expose_paths PASSED [  7%]
src/tests/connection_management/test_secure_health_check.py::TestSecureHealthCheck::test_validate_configuration_doesnt_expose_errors PASSED [  7%]
src/tests/connection_management/test_secure_health_check.py::TestSecureHealthCheck::test_controller_sanitizes_response PASSED [  7%]
src/tests/connection_management/test_secure_health_check.py::TestSecureHealthCheck::test_error_handling_doesnt_expose_details PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_initialization PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_get_current_agent_default PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_set_and_get_current_agent PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_set_agent_with_at_prefix PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_multiple_sessions PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_persistent_storage PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_state_file_corruption_handling PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_state_file_missing PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_get_all_sessions PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_cleanup_old_sessions PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_timestamp_tracking PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentStateManager::test_save_state_error_handling PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestConvenienceFunctions::test_get_current_agent_function PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestConvenienceFunctions::test_set_current_agent_function PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentRoleMapping::test_get_agent_role_known_agents PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentRoleMapping::test_get_agent_role_unknown_agent PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentRoleMapping::test_get_agent_role_claude_agent PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestAgentRoleMapping::test_get_agent_role_empty_session PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestCallAgentIntegration::test_update_agent_state_from_call_agent PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestCallAgentIntegration::test_update_agent_state_with_at_prefix PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestCallAgentIntegration::test_update_agent_state_empty_input PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestCallAgentIntegration::test_update_agent_state_empty_session PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestStateFileFormats::test_load_valid_state_file PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestStateFileFormats::test_load_empty_state_file PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestStateFileFormats::test_load_malformed_json PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestStateFileFormats::test_state_file_permissions_error PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestConcurrencyAndThreadSafety::test_concurrent_state_updates PASSED [  7%]
src/tests/hooks/test_agent_state_manager.py::TestConcurrencyAndThreadSafety::test_concurrent_same_session_updates PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjectionConfig::test_default_config PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjectionConfig::test_custom_config PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_mcp_task_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_mcp_subtask_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_mcp_context_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_file_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_git_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_search_operations_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_irrelevant_operations PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_file_extension_filtering PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextRelevanceDetector::test_mcp_action_filtering PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_context_cache_hit PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_mcp_operation_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_file_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_git_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_search_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_query_context_error_handling PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_get_recent_tasks PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_get_task_context_different_response_formats PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_documentation_path_calculation PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestMCPContextQuery::test_cache_key_creation PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_inject_context_not_relevant PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_inject_context_success PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_inject_context_no_data PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_inject_context_error_handling PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_performance_threshold_monitoring PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_task_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_git_branch_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_documentation_context PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_related_tasks PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_git_status PASSED [  7%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_long_task_details PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestContextInjector::test_format_context_injection_limit_related_tasks PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestConvenienceFunctions::test_create_context_injector PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestConvenienceFunctions::test_inject_context_sync PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestConvenienceFunctions::test_inject_context_sync_error_handling PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestConvenienceFunctions::test_inject_context_sync_timeout PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestIntegrationScenarios::test_end_to_end_task_context_injection PASSED [  8%]
src/tests/hooks/test_context_injector.py::TestIntegrationScenarios::test_performance_under_load PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextSynchronizerLogic::test_add_context_change PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextSynchronizerLogic::test_pending_changes_limit PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextSynchronizerLogic::test_sync_success PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextSynchronizerLogic::test_conflict_detection PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextSynchronizerLogic::test_no_conflicts_different_contexts PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestConflictResolutionLogic::test_latest_wins_strategy PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestConflictResolutionLogic::test_priority_based_strategy PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestConflictResolutionLogic::test_merge_compatible_strategy PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestConflictResolutionLogic::test_merge_fallback_on_conflicts PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestAgentStateManagerIntegration::test_agent_state_persistence PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestAgentStateManagerIntegration::test_agent_role_mapping PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestAgentStateManagerIntegration::test_multiple_sessions PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextInjectionLogic::test_mcp_operation_relevance PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextInjectionLogic::test_file_operation_relevance PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextInjectionLogic::test_irrelevant_operation PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestContextInjectionLogic::test_git_operation_relevance PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestIntegrationScenarios::test_context_sync_before_injection PASSED [  8%]
src/tests/hooks/test_context_utilities_simple.py::TestIntegrationScenarios::test_concurrent_operations PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_complete_read_tool_workflow PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_dangerous_bash_command_blocking PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_env_file_protection_workflow PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_ai_docs_update_workflow PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_mcp_task_management_workflow FAILED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_hook_chain_with_logging PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_hook_performance_e2e PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_hook_error_recovery_e2e PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookIntegrationWithSystem::test_real_file_operations PASSED [  8%]
src/tests/hooks/test_hook_e2e.py::TestHookIntegrationWithSystem::test_hook_system_with_project_structure PASSED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_complete_pre_tool_workflow FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_complete_post_tool_workflow FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_hook_validation_blocking PASSED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_env_file_protection_integration PASSED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_hook_performance_integration FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_error_resilience_integration PASSED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_logging_integration PASSED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_mcp_tool_chain_integration FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_documentation_workflow_integration FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_agent_state_tracking_integration FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookSystemReliability::test_concurrent_execution_safety FAILED [  8%]
src/tests/hooks/test_hook_integration.py::TestHookSystemReliability::test_malformed_input_handling PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_pre_hook_validation_chain PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_post_hook_component_chain PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_file_logger_integration PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_component_factory_integration PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_hook_resilience_to_component_failures PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_hook_performance_baseline PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_hook_memory_stability PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_json_processing_robustness PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_error_message_quality PASSED [  8%]
src/tests/hooks/test_hook_integration_simple.py::TestHookSystemIntegration::test_logging_format_consistency PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestFileLogger::test_file_logger_initialization PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestFileLogger::test_file_logger_logging PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestFileLogger::test_file_logger_rotation PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_root_file_validator_allowed_files PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_env_file_validator PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_command_validator_dangerous_commands PASSED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_documentation_validator FAILED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_permission_validator FAILED [  8%]
src/tests/hooks/test_hook_system_comprehensive.py::TestProcessorComponents::test_context_processor FAILED [  8%]
üßπ Performing final test data cleanup...
üßπ Final cleanup completed:
   - 0 test data files removed
   - 0 temporary directories removed
‚úÖ Test environment is clean


=================================== FAILURES ===================================
_____________ TestRegisterEndpoint.test_register_invalid_password ______________
src/tests/auth/interface/auth_endpoints_test.py:663: in test_register_invalid_password
    assert "account created" in data["message"].lower()
E   AssertionError: assert 'account created' in 'registration successful'
E    +  where 'registration successful' = <built-in method lower of str object at 0x78d50627b470>()
E    +    where <built-in method lower of str object at 0x78d50627b470> = 'Registration successful'.lower
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:11,107 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,109 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:11,110 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:11,110 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:11,110 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:11,110 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:11,110 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:11,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:11,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:11,111 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:11,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:11,112 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:11,112 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,112 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:11,112 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:11,113 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 31db6ece-cfc5-4636-9722-93453ae03ce2)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
_______________ TestRegisterEndpoint.test_register_invalid_email _______________
src/tests/auth/interface/auth_endpoints_test.py:681: in test_register_invalid_email
    assert "account created" in data["message"].lower()
E   AssertionError: assert 'account created' in 'registration successful'
E    +  where 'registration successful' = <built-in method lower of str object at 0x78d50627b470>()
E    +    where <built-in method lower of str object at 0x78d50627b470> = 'Registration successful'.lower
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:11,167 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,170 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:11,171 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:11,171 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:11,171 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:11,171 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:11,171 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:11,172 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:11,172 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,172 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:11,172 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:11,172 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:11,173 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:11,173 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,174 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:11,174 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:11,174 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 3530874d-2cca-4b0d-ab73-1037d4da59a4)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
__________________ TestIntegration.test_clock_skew_tolerance ___________________
src/tests/auth/keycloak_dependencies_test.py:473: in test_clock_skew_tolerance
    mock_decode.assert_called_with(
/usr/lib/python3.12/unittest/mock.py:944: in assert_called_with
    raise AssertionError(_error_message()) from cause
E   AssertionError: expected call not found.
E   Expected: decode('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJza2V3LXVzZXIiLCJleHAiOjE3NTgwODY0NTEuNjQ4NTg0fQ.hQ13CV6kSKVRHQzSBG5itj1WtCRzR0wy1UBcj1ER2kE', 'test-secret-key-for-testing-only-do-not-use-in-production', algorithms=['HS256'], leeway=30)
E     Actual: decode('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJza2V3LXVzZXIiLCJleHAiOjE3NTgwODY0NTEuNjQ4NTg0fQ.hQ13CV6kSKVRHQzSBG5itj1WtCRzR0wy1UBcj1ER2kE', 'test-secret-key-for-testing', algorithms=['HS256'], leeway=30)
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:11,640 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:11,642 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:11,642 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:11,643 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:11,644 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:11,644 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,644 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:11,645 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:11,645 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:11,645 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:11,645 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:11,646 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:11,646 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:11,646 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 5d475b98-751d-4291-bcf8-aba28b710f4c)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------
2025-09-17 07:21:11,648 - fastmcp.auth.keycloak_dependencies - INFO - Authenticated local user: skew-user
------------------------------ Captured log call -------------------------------
INFO     fastmcp.auth.keycloak_dependencies:keycloak_dependencies.py:239 Authenticated local user: skew-user
_______ TestSupabaseConnectionFix.test_current_environment_configuration _______
Expected None, but test returned ('sqlite', None, False). Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,293 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,295 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,296 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,296 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,296 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,296 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,297 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,297 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,297 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,297 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,298 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,298 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,298 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,299 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,299 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,299 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: e5c91524-5c14-4db9-85d6-0f3d048c6869)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

=== TESTING CURRENT ENVIRONMENT CONFIGURATION ===
DATABASE_TYPE: sqlite
DATABASE_URL: NOT SET
SUPABASE_URL: NOT SET
SUPABASE_DB_PASSWORD: NOT SET
is_supabase_configured(): False
‚ö†Ô∏è  Unexpected configuration state: DATABASE_TYPE=sqlite, configured=False
‚ùå SupabaseConfig failed: üö´ SUPABASE CONFIGURATION MISSING! üö´
Required: One of the following configurations:
1. SUPABASE_DATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres
2. DATABASE_URL with Supabase connection string
3. Individual Supabase variables: SUPABASE_URL, SUPABASE_DB_PASSWORD, etc.
Current SUPABASE_URL: NOT SET
Current DATABASE_URL: NOT SET
_____________ TestSupabaseConnectionFix.test_fix_with_database_url _____________
Expected None, but test returned False. Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,303 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,305 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,305 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,305 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,306 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,307 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,307 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,307 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,307 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,307 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,308 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,308 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,309 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,309 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,309 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: b8f324eb-642a-4966-8708-494d32e36c12)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

=== TESTING FIX WITH DATABASE_URL ===
2025-09-17 07:21:12,312 - fastmcp.task_management.infrastructure.database.supabase_config - INFO - üéØ Using DATABASE_URL (contains Supabase)
2025-09-17 07:21:12,548 - fastmcp.task_management.infrastructure.database.supabase_config - ERROR - Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (13.48.169.15), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
‚ùå Fix with DATABASE_URL failed: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (13.48.169.15), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
------------------------------ Captured log call -------------------------------
INFO     fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:61 üéØ Using DATABASE_URL (contains Supabase)
ERROR    fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:202 Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (13.48.169.15), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
________ TestSupabaseConnectionFix.test_fix_with_supabase_database_url _________
Expected None, but test returned False. Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,555 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,559 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,559 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,560 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,561 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,561 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,562 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,562 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,563 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,563 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,563 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,564 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,564 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,564 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,564 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,564 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: f1a28810-f13f-426e-b2ea-c332aa2b8407)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

=== TESTING FIX WITH SUPABASE_DATABASE_URL ===
2025-09-17 07:21:12,567 - fastmcp.task_management.infrastructure.database.supabase_config - INFO - üéØ Using SUPABASE_DATABASE_URL (direct connection)
2025-09-17 07:21:12,739 - fastmcp.task_management.infrastructure.database.supabase_config - ERROR - Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
‚ùå Fix with SUPABASE_DATABASE_URL failed: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
------------------------------ Captured log call -------------------------------
INFO     fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:55 üéØ Using SUPABASE_DATABASE_URL (direct connection)
ERROR    fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:202 Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
________ TestSupabaseConnectionFix.test_component_construction_fallback ________
Expected None, but test returned False. Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,745 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,749 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,751 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,751 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,751 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,751 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,751 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,752 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,752 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,752 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,753 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,753 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 1967770e-4d04-41b3-887f-26b101bcc55d)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

=== TESTING COMPONENT CONSTRUCTION FALLBACK ===
‚ùå Component construction failed: üö´ SUPABASE CONFIGURATION MISSING! üö´
Required: One of the following configurations:
1. SUPABASE_DATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres
2. DATABASE_URL with Supabase connection string
3. Individual Supabase variables: SUPABASE_URL, SUPABASE_DB_PASSWORD, etc.
Current SUPABASE_URL: SET
Current DATABASE_URL: NOT SET
This indicates a bug in the component construction logic
___________ TestSupabaseConnectionFix.test_database_config_with_fix ____________
Expected None, but test returned False. Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,757 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,761 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,761 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,761 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,762 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,762 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,762 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,763 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,763 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,763 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,763 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,763 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 1a0000cc-a568-4d5e-bb29-0c319f4d6104)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

=== TESTING DATABASE CONFIG INTEGRATION ===
2025-09-17 07:21:12,767 - fastmcp.task_management.infrastructure.database.database_config - ERROR - Supabase configuration incomplete. Required: SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
‚ùå DatabaseConfig integration test failed: Database configuration missing for supabase.
Required environment variables:
SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "/home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/auth/mcp_integration/test_supabase_connection_fix.py", line 195, in test_database_config_with_fix
    db_config = DatabaseConfig()
                ^^^^^^^^^^^^^^^^
  File "/home/daihungpham/__projects__/agentic-project/4genthub_main/src/fastmcp/task_management/infrastructure/database/database_config.py", line 134, in __init__
    raise ValueError(
ValueError: Database configuration missing for supabase.
Required environment variables:
SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
------------------------------ Captured log call -------------------------------
ERROR    fastmcp.task_management.infrastructure.database.database_config:database_config.py:201 Supabase configuration incomplete. Required: SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
____________ TestSupabaseConnectionFix.test_complete_fix_validation ____________
Expected None, but test returned {'current_state': {'database_type': 'sqlite', 'database_url_set': False, 'supabase_configured': False}, 'database_url_fix': False, 'supabase_database_url_fix': False, 'component_construction': False, 'integration': False}. Did you mean to use `assert` instead of `return`?
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:12,769 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:12,771 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:12,771 - fastmcp.task_management.infrastructure.database.database_config - WARNING - Error closing database instance during reset: 'DatabaseConfig' object has no attribute 'engine'

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,771 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:12,771 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:12,772 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:12,773 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:12,773 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,773 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:12,774 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:12,774 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:12,774 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:12,774 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:12,775 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:12,775 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:12,775 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 72a1baa7-6a8a-401d-81af-5cf6f36556ea)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
WARNING  fastmcp.task_management.infrastructure.database.database_config:database_config.py:95 Error closing database instance during reset: 'DatabaseConfig' object has no attribute 'engine'
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------

================================================================================
COMPLETE FIX VALIDATION TEST
================================================================================

=== TESTING CURRENT ENVIRONMENT CONFIGURATION ===
DATABASE_TYPE: sqlite
DATABASE_URL: NOT SET
SUPABASE_URL: NOT SET
SUPABASE_DB_PASSWORD: NOT SET
is_supabase_configured(): False
‚ö†Ô∏è  Unexpected configuration state: DATABASE_TYPE=sqlite, configured=False
‚ùå SupabaseConfig failed: üö´ SUPABASE CONFIGURATION MISSING! üö´
Required: One of the following configurations:
1. SUPABASE_DATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres
2. DATABASE_URL with Supabase connection string
3. Individual Supabase variables: SUPABASE_URL, SUPABASE_DB_PASSWORD, etc.
Current SUPABASE_URL: NOT SET
Current DATABASE_URL: NOT SET

=== TESTING FIX WITH DATABASE_URL ===
2025-09-17 07:21:12,777 - fastmcp.task_management.infrastructure.database.supabase_config - INFO - üéØ Using DATABASE_URL (contains Supabase)
2025-09-17 07:21:12,955 - fastmcp.task_management.infrastructure.database.supabase_config - ERROR - Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
‚ùå Fix with DATABASE_URL failed: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)

=== TESTING FIX WITH SUPABASE_DATABASE_URL ===
2025-09-17 07:21:12,957 - fastmcp.task_management.infrastructure.database.supabase_config - INFO - üéØ Using SUPABASE_DATABASE_URL (direct connection)
2025-09-17 07:21:13,141 - fastmcp.task_management.infrastructure.database.supabase_config - ERROR - Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
‚ùå Fix with SUPABASE_DATABASE_URL failed: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)

=== TESTING COMPONENT CONSTRUCTION FALLBACK ===
‚ùå Component construction failed: üö´ SUPABASE CONFIGURATION MISSING! üö´
Required: One of the following configurations:
1. SUPABASE_DATABASE_URL=postgresql://postgres:password@db.project.supabase.co:5432/postgres
2. DATABASE_URL with Supabase connection string
3. Individual Supabase variables: SUPABASE_URL, SUPABASE_DB_PASSWORD, etc.
Current SUPABASE_URL: SET
Current DATABASE_URL: NOT SET
This indicates a bug in the component construction logic

=== TESTING DATABASE CONFIG INTEGRATION ===
2025-09-17 07:21:13,148 - fastmcp.task_management.infrastructure.database.database_config - ERROR - Supabase configuration incomplete. Required: SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
‚ùå DatabaseConfig integration test failed: Database configuration missing for supabase.
Required environment variables:
SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD

================================================================================
FIX VALIDATION RESULTS
================================================================================
Current Configuration Issue: CONFIRMED
DATABASE_URL Fix Works: ‚ùå NO
SUPABASE_DATABASE_URL Fix Works: ‚ùå NO
Component Construction Works: ‚ùå NO
Full Integration Works: ‚ùå NO

--------------------------------------------------------------------------------
RECOMMENDED FIX
--------------------------------------------------------------------------------
‚ùå ISSUE: No fix method worked - deeper investigation needed
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "/home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/auth/mcp_integration/test_supabase_connection_fix.py", line 195, in test_database_config_with_fix
    db_config = DatabaseConfig()
                ^^^^^^^^^^^^^^^^
  File "/home/daihungpham/__projects__/agentic-project/4genthub_main/src/fastmcp/task_management/infrastructure/database/database_config.py", line 134, in __init__
    raise ValueError(
ValueError: Database configuration missing for supabase.
Required environment variables:
SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
------------------------------ Captured log call -------------------------------
INFO     fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:61 üéØ Using DATABASE_URL (contains Supabase)
ERROR    fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:202 Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO     fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:55 üéØ Using SUPABASE_DATABASE_URL (direct connection)
ERROR    fastmcp.task_management.infrastructure.database.supabase_config:supabase_config.py:202 Failed to initialize Supabase database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 5432 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    fastmcp.task_management.infrastructure.database.database_config:database_config.py:201 Supabase configuration incomplete. Required: SUPABASE_DB_HOST, SUPABASE_DB_PASSWORD
________________ TestHookE2E.test_mcp_task_management_workflow _________________
src/tests/hooks/test_hook_e2e.py:211: in test_mcp_task_management_workflow
    with patch('utils.env_loader.get_ai_data_path', return_value=tmp_path), \
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'utils' has no attribute 'mcp_post_action_hints'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:21,183 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:21,187 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:21,188 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:21,188 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:21,189 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:21,189 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:21,189 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:21,189 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:21,189 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:21,190 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:21,190 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:21,191 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:21,191 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:21,191 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 8fbc1577-a4b3-49ab-b047-be1754ae9ec5)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
_____________ TestHookIntegration.test_complete_pre_tool_workflow ______________
src/tests/hooks/test_hook_integration.py:49: in test_complete_pre_tool_workflow
    with self.setup_mock_environment(tmp_path):
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src/tests/hooks/test_hook_integration.py:30: in setup_mock_environment
    with patch.multiple('utils.env_loader',
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'utils' has no attribute 'mcp_post_action_hints'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:36,400 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:36,412 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:36,412 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,412 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:36,412 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:36,412 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:36,413 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:36,414 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:36,414 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,415 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:36,415 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:36,415 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:36,416 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:36,416 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,417 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:36,417 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:36,417 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 3019debf-c78b-4ee9-b7dc-4af9fb4d2da4)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
_____________ TestHookIntegration.test_complete_post_tool_workflow _____________
src/tests/hooks/test_hook_integration.py:81: in test_complete_post_tool_workflow
    with self.setup_mock_environment(tmp_path):
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src/tests/hooks/test_hook_integration.py:30: in setup_mock_environment
    with patch.multiple('utils.env_loader',
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'utils' has no attribute 'mcp_post_action_hints'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:36,448 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:36,451 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:36,452 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:36,452 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:36,452 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:36,452 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:36,453 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:36,453 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,453 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:36,453 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:36,453 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:36,454 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:36,454 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,455 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:36,455 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:36,455 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 9e82718d-4042-425a-bf50-7d8b751a6dea)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
____________ TestHookIntegration.test_hook_performance_integration _____________
src/tests/hooks/test_hook_integration.py:137: in test_hook_performance_integration
    with self.setup_mock_environment(tmp_path):
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src/tests/hooks/test_hook_integration.py:30: in setup_mock_environment
    with patch.multiple('utils.env_loader',
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'utils' has no attribute 'mcp_post_action_hints'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:36,506 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:36,509 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:36,510 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:36,510 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:36,511 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:36,511 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,511 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:36,512 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:36,512 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:36,512 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:36,513 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:36,513 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:36,513 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:36,513 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 50905159-5709-4274-bd93-be27025bc166)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
___________ TestHookChainIntegration.test_mcp_tool_chain_integration ___________
src/tests/hooks/test_hook_integration.py:260: in test_mcp_tool_chain_integration
    with patch('utils.mcp_task_interceptor.get_mcp_interceptor') as mock_interceptor, \
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'utils' has no attribute 'mcp_post_action_hints'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:39,591 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:39,595 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:39,596 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:39,597 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:39,597 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:39,597 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:39,598 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:39,598 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:39,598 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:39,599 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:39,599 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:39,599 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:39,599 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:39,599 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 74e62d62-9001-415e-90c7-b0f2c5c65e99)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
_______ TestHookChainIntegration.test_documentation_workflow_integration _______
src/tests/hooks/test_hook_integration.py:321: in test_documentation_workflow_integration
    mock_update.assert_called_with(ai_docs_dir)
/usr/lib/python3.12/unittest/mock.py:944: in assert_called_with
    raise AssertionError(_error_message()) from cause
E   AssertionError: expected call not found.
E   Expected: update_index(PosixPath('/tmp/pytest-of-daihungpham/pytest-41/test_documentation_workflow_in0/ai_docs'))
E     Actual: update_index(PosixPath('/home/daihungpham/__projects__/agentic-project/4genthub_main/ai_docs'))
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:39,626 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:39,629 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:39,629 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:39,629 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:39,629 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:39,629 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:39,630 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:39,631 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:39,631 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:39,631 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:39,631 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:39,631 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:39,632 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:39,632 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:39,633 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:39,633 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:39,633 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: add4d482-5632-4ed4-a7b5-166ab6da7c8b)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
----------------------------- Captured stdout call -----------------------------
2025-09-17 07:21:39,637 - utils.context_updater - INFO - Context update triggered for Write (type: file_created, priority: medium)
2025-09-17 07:21:39,639 - utils.mcp_client - WARNING - Request failed: 404
2025-09-17 07:21:40,646 - utils.mcp_client - WARNING - Request failed: 404
2025-09-17 07:21:42,650 - utils.mcp_client - WARNING - Request failed: 404
2025-09-17 07:21:42,651 - utils.mcp_client - ERROR - All retries exhausted. Last error: None
2025-09-17 07:21:42,651 - utils.context_updater - INFO - Context update completed in 3014.10ms
2025-09-17 07:21:42,651 - utils.context_updater - WARNING - Context update exceeded timeout: 3014.10ms > 1000ms
------------------------------ Captured log call -------------------------------
INFO     utils.context_updater:context_updater.py:495 Context update triggered for Write (type: file_created, priority: medium)
WARNING  utils.mcp_client:mcp_client.py:490 Request failed: 404
WARNING  utils.mcp_client:mcp_client.py:490 Request failed: 404
WARNING  utils.mcp_client:mcp_client.py:490 Request failed: 404
ERROR    utils.mcp_client:mcp_client.py:460 All retries exhausted. Last error: None
INFO     utils.context_updater:context_updater.py:507 Context update completed in 3014.10ms
WARNING  utils.context_updater:context_updater.py:511 Context update exceeded timeout: 3014.10ms > 1000ms
________ TestHookChainIntegration.test_agent_state_tracking_integration ________
src/tests/hooks/test_hook_integration.py:338: in test_agent_state_tracking_integration
    result = hook.execute(agent_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^
../.claude/hooks/post_tool_use.py:318: in execute
    combined_output = "\n\n".join(output_parts)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: sequence item 0: expected str instance, list found
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:42,683 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:42,686 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:42,687 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:42,688 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:42,688 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:42,689 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:42,689 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:42,689 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:42,690 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:42,690 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:42,690 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:42,690 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:42,690 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 0e36ae53-4486-4a8f-86ea-30c924027912)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
__________ TestHookSystemReliability.test_concurrent_execution_safety __________
src/tests/hooks/test_hook_integration.py:366: in test_concurrent_execution_safety
    with patch('utils.env_loader.get_ai_data_path', return_value=tmp_path), \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'pre_tool_use' from '/home/daihungpham/__projects__/agentic-project/.claude/hooks/pre_tool_use.py'> does not have the attribute 'check_documentation_requirement'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:42,701 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:42,704 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:42,704 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:42,704 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:42,704 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:42,704 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:42,705 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:42,706 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:42,706 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:42,706 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:42,706 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:42,706 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:42,707 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:42,707 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:42,708 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:42,708 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:42,708 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 459696ab-9c23-430e-af75-e61515f64fe1)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
_____________ TestValidatorComponents.test_documentation_validator _____________
/usr/lib/python3.12/unittest/mock.py:1387: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1369: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'pre_tool_use' from '/home/daihungpham/__projects__/agentic-project/.claude/hooks/pre_tool_use.py'> does not have the attribute 'is_file_in_session'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:43,194 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:43,198 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:43,199 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:43,199 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:43,199 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:43,199 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:43,199 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:43,200 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,200 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:43,200 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:43,200 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:43,201 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:43,201 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,202 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:43,202 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:43,202 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: 8be3b97b-dec1-4e2d-aa3c-b69c2b9307e6)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
______________ TestValidatorComponents.test_permission_validator _______________
/usr/lib/python3.12/unittest/mock.py:1387: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1369: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'pre_tool_use' from '/home/daihungpham/__projects__/agentic-project/.claude/hooks/pre_tool_use.py'> does not have the attribute 'check_tool_permission'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:43,244 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:43,247 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:43,247 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,247 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:43,247 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:43,247 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:43,248 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:43,249 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:43,249 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,249 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:43,250 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:43,250 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:43,250 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:43,250 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,251 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:43,251 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:43,251 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: c1e77e4b-bfc3-425f-ad33-9f2f2a064954)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
________________ TestProcessorComponents.test_context_processor ________________
/usr/lib/python3.12/unittest/mock.py:1387: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1369: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'pre_tool_use' from '/home/daihungpham/__projects__/agentic-project/.claude/hooks/pre_tool_use.py'> does not have the attribute 'inject_context_sync'
---------------------------- Captured stdout setup -----------------------------
2025-09-17 07:21:43,297 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-17 07:21:43,300 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-17 07:21:43,300 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,300 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/4genthub_test.db
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode for test execution
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-17 07:21:43,301 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-17 07:21:43,302 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-17 07:21:43,302 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,303 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-17 07:21:43,303 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-17 07:21:43,303 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-17 07:21:43,304 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-17 07:21:43,304 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-17 07:21:43,304 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-17 07:21:43,304 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-17 07:21:43,304 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/4genthub_test.db
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: d1d9bda3-f149-48fb-a0a7-cc438380f2a4)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:127 üì¶ SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:145 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:217 üì¶ Using SQLite database for tests: /tmp/4genthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:252 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:270 ‚úÖ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:342 üì¶ Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:379 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:381 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:36 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:415 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:417 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:421 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:423 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:41 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/4genthub_test.db
=============================== warnings summary ===============================
src/tests/conftest.py:255
  /home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/conftest.py:255: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: auth/interface/auth_endpoints_test.py)
    class MockFastAPIClient:

src/tests/conftest.py:255
  /home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/conftest.py:255: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: server/app_factory_test.py)
    class MockFastAPIClient:

src/tests/conftest.py:255
  /home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/conftest.py:255: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: task_management/infrastructure/monitoring/metrics_integration_test.py)
    class MockFastAPIClient:

src/tests/conftest.py:255
  /home/daihungpham/__projects__/agentic-project/4genthub_main/src/tests/conftest.py:255: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: unit/auth/interface/auth_endpoints_test.py)
    class MockFastAPIClient:

ai_task_planning/application/services/ai_planning_service_test.py: 68 warnings
ai_task_planning/application/test_application_init.py: 8 warnings
ai_task_planning/domain/entities/planning_request_test.py: 52 warnings
ai_task_planning/domain/entities/task_plan_test.py: 96 warnings
ai_task_planning/domain/services/requirement_analyzer_test.py: 68 warnings
ai_task_planning/domain/services/test_services_init.py: 8 warnings
ai_task_planning/domain/test_domain_init.py: 8 warnings
ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py: 124 warnings
ai_task_planning/interface/test_interface_init.py: 8 warnings
ai_task_planning/test_ai_planning_init.py: 8 warnings
auth/api/enhanced_auth_endpoints_test.py: 68 warnings
auth/dependencies_test.py: 60 warnings
auth/hook_auth_test.py: 120 warnings
auth/infrastructure/repositories/email_token_repository_test.py: 152 warnings
auth/interface/auth_endpoints_test.py: 180 warnings
auth/keycloak_dependencies_test.py: 88 warnings
auth/keycloak_integration_test.py: 136 warnings
auth/mcp_dependencies_test.py: 80 warnings
auth/mcp_integration/test_database_connection_analysis.py: 20 warnings
auth/mcp_integration/test_supabase_connection_fix.py: 24 warnings
auth/mcp_keycloak_auth_test.py: 136 warnings
auth/middleware/request_context_middleware_test.py: 76 warnings
auth/models/api_token_test.py: 96 warnings
auth/service_account_test.py: 152 warnings
connection_management/interface/controllers/connection_mcp_controller_test.py: 52 warnings
connection_management/test_secure_health_check.py: 16 warnings
hooks/test_agent_state_manager.py: 112 warnings
hooks/test_context_injector.py: 156 warnings
hooks/test_context_utilities_simple.py: 72 warnings
hooks/test_hook_e2e.py: 40 warnings
hooks/test_hook_integration.py: 48 warnings
hooks/test_hook_integration_simple.py: 40 warnings
hooks/test_hook_system_comprehensive.py: 36 warnings
  /home/daihungpham/__projects__/agentic-project/4genthub_main/.venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py:943: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cursor.execute(statement, parameters)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_invalid_password
FAILED src/tests/auth/interface/auth_endpoints_test.py::TestRegisterEndpoint::test_register_invalid_email
FAILED src/tests/auth/keycloak_dependencies_test.py::TestIntegration::test_clock_skew_tolerance
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_current_environment_configuration
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_fix_with_database_url
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_fix_with_supabase_database_url
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_component_construction_fallback
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_database_config_with_fix
FAILED src/tests/auth/mcp_integration/test_supabase_connection_fix.py::TestSupabaseConnectionFix::test_complete_fix_validation
FAILED src/tests/hooks/test_hook_e2e.py::TestHookE2E::test_mcp_task_management_workflow
FAILED src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_complete_pre_tool_workflow
FAILED src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_complete_post_tool_workflow
FAILED src/tests/hooks/test_hook_integration.py::TestHookIntegration::test_hook_performance_integration
FAILED src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_mcp_tool_chain_integration
FAILED src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_documentation_workflow_integration
FAILED src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_agent_state_tracking_integration
FAILED src/tests/hooks/test_hook_integration.py::TestHookSystemReliability::test_concurrent_execution_safety
FAILED src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_documentation_validator
FAILED src/tests/hooks/test_hook_system_comprehensive.py::TestValidatorComponents::test_permission_validator
FAILED src/tests/hooks/test_hook_system_comprehensive.py::TestProcessorComponents::test_context_processor
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 20 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
========== 20 failed, 582 passed, 3 skipped, 2412 warnings in 39.21s ===========
