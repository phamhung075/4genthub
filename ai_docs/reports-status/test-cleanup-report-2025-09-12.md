# Test Cleanup Report - 2025-09-12

## Executive Summary
The test suite has collection errors due to test files that were created for non-existent modules. These test files need to be removed or their imports need to be fixed.

## Analysis of Failing Tests

### 1. Tests for Non-Existent Modules
These test files reference source modules that don't exist:
- `dhafnck_mcp_main/src/tests/server/routes/token_mgmt_routes_test.py` - No `server/routes` module exists
- `dhafnck_mcp_main/src/tests/server/auth/providers/jwt_bearer_test.py` - Need to check if module exists

### 2. Tests with Wrong Import Paths
These tests exist but have incorrect imports:
- `enhanced_auth_endpoints_test.py` - Fixed by removing direct function imports

### 3. Tests That May Be Valid
These tests might be valid but need verification:
- `context_search_test.py`
- `context_versioning_test.py`  
- `batch_context_operations_test.py`
- `context_templates_test.py`
- `token_repository_test.py`
- `context_notifications_test.py`

## Recommended Actions

### Immediate Actions
1. **Remove tests for non-existent modules**:
   - Remove entire `dhafnck_mcp_main/src/tests/server/` directory if server module doesn't exist
   
2. **Fix import paths in existing tests**:
   - Verify source modules exist before keeping tests
   - Update import paths to match actual module structure

3. **Update TEST-CHANGELOG.md**:
   - Document which tests were removed
   - Note which tests were fixed

### Verification Steps
```bash
# Check which source modules actually exist
find dhafnck_mcp_main/src/fastmcp -type f -name "*.py" | grep -E "(context_search|context_versioning|batch_context|token_repository)"

# List all failing test files
cd dhafnck_mcp_main
python -m pytest src/tests --co -q 2>&1 | grep ERROR

# Test individual files
python -m pytest src/tests/task_management/application/use_cases/context_search_test.py -v
```

## Root Cause
The test files were generated by an AI agent that created tests for modules that were planned but not yet implemented. This is a common issue when generating tests before implementation.

## Prevention
- Only create tests for existing modules
- Verify module existence before creating tests
- Use test-driven development (TDD) approach where tests are created alongside implementation

## Status
- **Total Failing Tests**: 23
- **Fixed**: 1 (enhanced_auth_endpoints_test.py)
- **To Be Removed**: ~10-15 (tests for non-existent modules)
- **To Be Fixed**: ~7-8 (tests with wrong imports)

## Next Steps
1. Clean up test directory structure
2. Remove tests for non-existent modules
3. Fix remaining import issues
4. Run full test suite to verify
5. Update documentation