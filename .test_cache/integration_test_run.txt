
🧪 Starting agenthub Test Suite
🛡️  Test data isolation enabled
🧹 Automatic cleanup configured
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.1, pluggy-1.6.0 -- /usr/bin/python
cachedir: .pytest_cache
rootdir: /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests
configfile: pytest.ini
plugins: postgresql-7.0.2, cov-6.2.1, anyio-4.9.0, asyncio-1.0.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... Warning: Cannot create log directory /app/logs, disabling file logging
2025-09-23 05:42:41,258 - fastmcp.task_management.infrastructure.repositories.git_branch_repository_factory - INFO - Registered git branch repository type: orm
2025-09-23 05:42:41,258 - fastmcp.task_management.infrastructure.repositories.git_branch_repository_factory - INFO - Registered git branch repository type: memory
2025-09-23 05:42:41,274 - FastMCP - INFO - File logging enabled: /home/daihungpham/__projects__/4genthub/agenthub_main/logs/agenthub.log (environment: local)
collected 140 items

src/tests/integration/agent_assignment_flow_test.py::TestAgentAssignmentAtCreation::test_create_task_with_multiple_assignees_success 2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set to: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,472 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite datetime adapters registered for Python 3.12+ compatibility
2025-09-23 05:42:41,473 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,477 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,478 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,478 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,479 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,479 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,479 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,480 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,480 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,480 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,481 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,481 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,500 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,502 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,513 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,514 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,519 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,520 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,531 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,532 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,541 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,542 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
📦 Initialized PostgreSQL test database with basic test data (branch_id: c9e8de00-b160-40de-a597-6db8e4d560f4)
2025-09-23 05:42:41,543 - fastmcp.task_management.infrastructure.repositories.base_user_scoped_repository - INFO - Repository initialized in system mode during startup - no user filtering applied (expected behavior)
2025-09-23 05:42:41,543 - fastmcp.task_management.application.services.context_cache_service - INFO - ContextCacheService initialized with 1h TTL
2025-09-23 05:42:41,543 - fastmcp.task_management.application.services.context_inheritance_service - INFO - ContextInheritanceService initialized
2025-09-23 05:42:41,543 - fastmcp.task_management.application.services.context_delegation_service - INFO - ContextDelegationService initialized
2025-09-23 05:42:41,543 - fastmcp.task_management.application.factories.unified_context_facade_factory - INFO - UnifiedContextFacadeFactory initialized with database
2025-09-23 05:42:41,544 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:41,544 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,546 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'coding-agent' to '@coding-agent'
2025-09-23 05:42:41,546 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee '@test-orchestrator-agent' to '@test-orchestrator-agent'
2025-09-23 05:42:41,546 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'documentation-agent' to '@documentation-agent'
2025-09-23 05:42:41,546 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Validated 3 assignees for task creation: ['@coding-agent', '@test-orchestrator-agent', '@documentation-agent']
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🎯 TaskApplicationFacade: get_current_user_id() returned: None (type: <class 'NoneType'>)
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🔄 TaskApplicationFacade: Fallback to request.user_id: None
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🔍 TaskApplicationFacade: Validating user_id: None
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - INFO - ✅ TaskApplicationFacade: Final validated user_id: test-user
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Error checking for duplicate creation: object of type 'Mock' has no len()
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - ERROR - Failed to create context for task 550e8400-e29b-41d4-a716-446655440000: 'dict' object has no attribute 'task'
2025-09-23 05:42:41,546 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Continuing with task creation despite context sync failure
2025-09-23 05:42:41,546 - fastmcp.task_management.application.services.websocket_notification_service - INFO - 🔔 sync_broadcast_task_event called from MCP server
2025-09-23 05:42:41,546 - fastmcp.task_management.application.services.websocket_notification_service - INFO - ✅ NOTIFICATION ALLOWED: created:task:550e8400-e29b-41d4-a716-446655440000:test-user
2025-09-23 05:42:41,546 - fastmcp.task_management.application.services.websocket_notification_service - INFO - 🔍 Fetching task context from database for created event
2025-09-23 05:42:41,577 - fastmcp.task_management.application.services.websocket_notification_service - ERROR - Failed to get task context for 550e8400-e29b-41d4-a716-446655440000: (builtins.TypeError) Expected UUID or string, got <class 'fastmcp.task_management.domain.value_objects.task_id.TaskId'>
[SQL: SELECT tasks.id AS tasks_id, tasks.title AS tasks_title, tasks.description AS tasks_description, tasks.git_branch_id AS tasks_git_branch_id, tasks.status AS tasks_status, tasks.priority AS tasks_priority, tasks.progress_history AS tasks_progress_history, tasks.progress_count AS tasks_progress_count, tasks.estimated_effort AS tasks_estimated_effort, tasks.due_date AS tasks_due_date, tasks.created_at AS tasks_created_at, tasks.updated_at AS tasks_updated_at, tasks.completed_at AS tasks_completed_at, tasks.completion_summary AS tasks_completion_summary, tasks.testing_notes AS tasks_testing_notes, tasks.context_id AS tasks_context_id, tasks.progress_percentage AS tasks_progress_percentage, tasks.progress_state AS tasks_progress_state, tasks.user_id AS tasks_user_id, tasks.ai_system_prompt AS tasks_ai_system_prompt, tasks.ai_request_prompt AS tasks_ai_request_prompt, tasks.ai_work_context AS tasks_ai_work_context, tasks.ai_completion_criteria AS tasks_ai_completion_criteria, tasks.ai_execution_history AS tasks_ai_execution_history, tasks.ai_last_execution AS tasks_ai_last_execution, tasks.ai_model_preferences AS tasks_ai_model_preferences, project_git_branchs.id AS project_git_branchs_id, project_git_branchs.project_id AS project_git_branchs_project_id, project_git_branchs.name AS project_git_branchs_name, project_git_branchs.description AS project_git_branchs_description, project_git_branchs.created_at AS project_git_branchs_created_at, project_git_branchs.updated_at AS project_git_branchs_updated_at, project_git_branchs.assigned_agent_id AS project_git_branchs_assigned_agent_id, project_git_branchs.agent_id AS project_git_branchs_agent_id, project_git_branchs.priority AS project_git_branchs_priority, project_git_branchs.status AS project_git_branchs_status, project_git_branchs.metadata AS project_git_branchs_metadata, project_git_branchs.task_count AS project_git_branchs_task_count, project_git_branchs.completed_task_count AS project_git_branchs_completed_task_count, project_git_branchs.user_id AS project_git_branchs_user_id 
FROM tasks JOIN project_git_branchs ON tasks.git_branch_id = project_git_branchs.id 
WHERE tasks.id = ? AND tasks.user_id = ?
 LIMIT ? OFFSET ?]
[parameters: [{}]]
2025-09-23 05:42:41,577 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Failed to broadcast task creation: 'TaskId' object is not subscriptable
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestAgentAssignmentAtCreation::test_create_task_with_invalid_assignees 2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,578 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,579 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,585 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,597 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,597 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,598 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,598 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,598 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,603 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,605 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,615 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,616 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,622 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,623 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,632 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,633 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,642 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,643 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
📦 Initialized PostgreSQL test database with basic test data (branch_id: 1decb6d0-89b4-4217-a375-ba3b7a82e113)
2025-09-23 05:42:41,645 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:41,645 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,645 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - WARNING - Invalid assignee: 'invalid-agent'
2025-09-23 05:42:41,645 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - WARNING - Invalid assignee: 'another-invalid'
2025-09-23 05:42:41,645 - fastmcp.task_management.interface.utils.response_formatter - INFO - Operation create_task completed with status failure (ID: b331bcfa-a56c-4e68-b89d-7798e92776ea)
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestAgentAssignmentAtCreation::test_create_task_empty_assignees 2025-09-23 05:42:41,646 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,647 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,648 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,648 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,648 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,651 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,652 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,662 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,662 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,663 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,663 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,663 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,667 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,668 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,673 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,675 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,679 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,680 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,685 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,686 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,693 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,694 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 694811, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 694812, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,695 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:41,695 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,695 - fastmcp.task_management.interface.utils.response_formatter - INFO - Operation create_task completed with status failure (ID: e02f9ccf-0a3d-4904-8da8-de522756380f)
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestAgentInheritanceFlow::test_create_subtask_inherits_parent_assignees 2025-09-23 05:42:41,696 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,697 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,698 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,698 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,698 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,698 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,702 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,702 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,702 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,702 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,703 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,703 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,703 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,713 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,713 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,713 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,713 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,714 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,718 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,719 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,726 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,727 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,731 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,732 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,739 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,740 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,746 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 747279, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 747281, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,748 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,748 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - INFO - Agent inheritance applied for subtask creation: ['coding-agent', '@test-orchestrator-agent']
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestAgentInheritanceFlow::test_create_subtask_with_explicit_assignees_no_inheritance 2025-09-23 05:42:41,749 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,749 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,750 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,760 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,770 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,770 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,771 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,771 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,771 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,774 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,775 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,781 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,782 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,788 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,789 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,794 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,796 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,801 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 801965, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 801965, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,802 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,803 - root - WARNING - Task created without an ID. Repository should assign one.
2025-09-23 05:42:41,803 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - INFO - Validated 1 assignees for subtask creation: ['@security-auditor-agent']
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestAgentInheritanceFlow::test_create_subtask_invalid_assignees 2025-09-23 05:42:41,803 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,804 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,805 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,809 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,821 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,821 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,822 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,822 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,822 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,825 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,826 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,831 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,832 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,836 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,837 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,843 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,844 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,849 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 849961, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 849962, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,850 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,850 - root - WARNING - Task created without an ID. Repository should assign one.
2025-09-23 05:42:41,850 - fastmcp.task_management.interface.utils.response_formatter - INFO - Operation create_subtask completed with status failure (ID: 5d9fce69-5f8e-4c54-a19a-7d36b0c04976)
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEndToEndAgentFlow::test_complete_task_to_subtask_flow 2025-09-23 05:42:41,851 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,851 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,852 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,856 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,856 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,856 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,856 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,856 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,857 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,857 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,866 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,867 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,867 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,867 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,867 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,870 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,872 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,878 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,879 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,883 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,884 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,889 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,890 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,897 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,897 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,897 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,897 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,898 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,898 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,898 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 898509, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 898510, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,899 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:41,899 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,899 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'coding-agent' to '@coding-agent'
2025-09-23 05:42:41,899 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'test-orchestrator-agent' to '@test-orchestrator-agent'
2025-09-23 05:42:41,899 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'documentation-agent' to '@documentation-agent'
2025-09-23 05:42:41,899 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Validated 3 assignees for task creation: ['@coding-agent', '@test-orchestrator-agent', '@documentation-agent']
2025-09-23 05:42:41,899 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🎯 TaskApplicationFacade: get_current_user_id() returned: None (type: <class 'NoneType'>)
2025-09-23 05:42:41,899 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🔄 TaskApplicationFacade: Fallback to request.user_id: None
2025-09-23 05:42:41,900 - fastmcp.task_management.application.facades.task_application_facade - INFO - 🔍 TaskApplicationFacade: Validating user_id: None
2025-09-23 05:42:41,900 - fastmcp.task_management.application.facades.task_application_facade - INFO - ✅ TaskApplicationFacade: Final validated user_id: test-user
2025-09-23 05:42:41,900 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Error checking for duplicate creation: object of type 'Mock' has no len()
2025-09-23 05:42:41,900 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Context creation failed for task parent-task-123, but task was created successfully
2025-09-23 05:42:41,900 - fastmcp.task_management.application.services.websocket_notification_service - INFO - 🔔 sync_broadcast_task_event called from MCP server
2025-09-23 05:42:41,900 - fastmcp.task_management.application.services.websocket_notification_service - INFO - ✅ NOTIFICATION ALLOWED: created:task:parent-task-123:test-user
2025-09-23 05:42:41,900 - fastmcp.task_management.application.services.websocket_notification_service - INFO - 🔍 Fetching task context from database for created event
2025-09-23 05:42:41,902 - fastmcp.task_management.application.services.websocket_notification_service - ERROR - Failed to get task context for parent-task-123: (builtins.TypeError) Expected UUID or string, got <class 'fastmcp.task_management.domain.value_objects.task_id.TaskId'>
[SQL: SELECT tasks.id AS tasks_id, tasks.title AS tasks_title, tasks.description AS tasks_description, tasks.git_branch_id AS tasks_git_branch_id, tasks.status AS tasks_status, tasks.priority AS tasks_priority, tasks.progress_history AS tasks_progress_history, tasks.progress_count AS tasks_progress_count, tasks.estimated_effort AS tasks_estimated_effort, tasks.due_date AS tasks_due_date, tasks.created_at AS tasks_created_at, tasks.updated_at AS tasks_updated_at, tasks.completed_at AS tasks_completed_at, tasks.completion_summary AS tasks_completion_summary, tasks.testing_notes AS tasks_testing_notes, tasks.context_id AS tasks_context_id, tasks.progress_percentage AS tasks_progress_percentage, tasks.progress_state AS tasks_progress_state, tasks.user_id AS tasks_user_id, tasks.ai_system_prompt AS tasks_ai_system_prompt, tasks.ai_request_prompt AS tasks_ai_request_prompt, tasks.ai_work_context AS tasks_ai_work_context, tasks.ai_completion_criteria AS tasks_ai_completion_criteria, tasks.ai_execution_history AS tasks_ai_execution_history, tasks.ai_last_execution AS tasks_ai_last_execution, tasks.ai_model_preferences AS tasks_ai_model_preferences, project_git_branchs.id AS project_git_branchs_id, project_git_branchs.project_id AS project_git_branchs_project_id, project_git_branchs.name AS project_git_branchs_name, project_git_branchs.description AS project_git_branchs_description, project_git_branchs.created_at AS project_git_branchs_created_at, project_git_branchs.updated_at AS project_git_branchs_updated_at, project_git_branchs.assigned_agent_id AS project_git_branchs_assigned_agent_id, project_git_branchs.agent_id AS project_git_branchs_agent_id, project_git_branchs.priority AS project_git_branchs_priority, project_git_branchs.status AS project_git_branchs_status, project_git_branchs.metadata AS project_git_branchs_metadata, project_git_branchs.task_count AS project_git_branchs_task_count, project_git_branchs.completed_task_count AS project_git_branchs_completed_task_count, project_git_branchs.user_id AS project_git_branchs_user_id 
FROM tasks JOIN project_git_branchs ON tasks.git_branch_id = project_git_branchs.id 
WHERE tasks.id = ? AND tasks.user_id = ?
 LIMIT ? OFFSET ?]
[parameters: [{}]]
2025-09-23 05:42:41,902 - fastmcp.task_management.application.facades.task_application_facade - WARNING - Failed to broadcast task creation: 'TaskId' object is not subscriptable
2025-09-23 05:42:41,902 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - INFO - Agent inheritance applied for subtask creation: ['coding-agent', '@test-orchestrator-agent', 'documentation-agent']
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEndToEndAgentFlow::test_multiple_subtasks_inheritance_scenarios 2025-09-23 05:42:41,903 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,903 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,904 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,908 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,920 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,920 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,921 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,921 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,921 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,924 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,925 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,931 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,932 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,936 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,937 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,943 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,944 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:41,953 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:41,953 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:41,953 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:41,953 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:41,953 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:41,954 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:41,954 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 41, 954406, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 41, 954407, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:41,954 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:41,955 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:41,955 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - INFO - Agent inheritance applied for subtask creation: ['coding-agent', '@test-orchestrator-agent']
2025-09-23 05:42:41,955 - root - WARNING - Task created without an ID. Repository should assign one.
2025-09-23 05:42:41,956 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - INFO - Validated 1 assignees for subtask creation: ['@security-auditor-agent']
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_task_with_mixed_valid_invalid_assignees 2025-09-23 05:42:41,956 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:41,957 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:41,957 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,957 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:41,957 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:41,957 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:41,958 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:41,962 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:41,972 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:41,972 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:41,973 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:41,973 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:41,973 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:41,977 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:41,978 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:41,985 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:41,986 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:41,990 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:41,991 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:41,997 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:41,998 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:42,003 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:42,003 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:42,003 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:42,003 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:42,003 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:42,004 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:42,004 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 42, 4373, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 42, 4374, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:42,004 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:42,005 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'coding-agent' to '@coding-agent'
2025-09-23 05:42:42,005 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - WARNING - Invalid assignee: 'invalid-agent'
2025-09-23 05:42:42,005 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'test-orchestrator-agent' to '@test-orchestrator-agent'
2025-09-23 05:42:42,005 - fastmcp.task_management.interface.utils.response_formatter - INFO - Operation create_task completed with status failure (ID: 96534f10-dc07-4370-a894-05dadd0d6a47)
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_subtask_parent_task_not_found 2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:42,007 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:42,008 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:42,011 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:42,011 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,012 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,012 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,012 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:42,012 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:42,012 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:42,023 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:42,023 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,024 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:42,024 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:42,024 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,027 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:42,028 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:42,033 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:42,035 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:42,039 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:42,044 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:42,049 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:42,050 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:42,055 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:42,056 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 42, 56817, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 42, 56818, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:42,057 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:42,057 - fastmcp.task_management.interface.mcp_controllers.subtask_mcp_controller.handlers.crud_handler - ERROR - Error creating subtask: Task parent-task-123 not found
2025-09-23 05:42:42,057 - fastmcp.task_management.interface.utils.response_formatter - INFO - Operation create_subtask completed with status failure (ID: 37a4f546-35c2-45e1-a19e-00b9616e49dc)
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_subtask_inheritance_service_failure 2025-09-23 05:42:42,058 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:42,058 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:42,059 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:42,063 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:42,064 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:42,074 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:42,074 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,075 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:42,075 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:42,075 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,079 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:42,080 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:42,086 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:42,087 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:42,091 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:42,092 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:42,097 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:42,098 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:42,103 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:42,103 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:42,103 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:42,103 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:42,104 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:42,104 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:42,104 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 42, 104770, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 42, 104771, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:42,105 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
PASSED
src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_validate_large_assignee_list 2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:42,106 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:42,107 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:42,111 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:42,121 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:42,122 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,122 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:42,122 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:42,122 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,125 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:42,127 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:42,132 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:42,133 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:42,137 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:42,138 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:42,143 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:42,144 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:42,149 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 42, 150236, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 42, 150237, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:42,150 - fastmcp.task_management.interface.utils.response_formatter - INFO - Response optimization is ENABLED
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'coding-agent' to '@coding-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'test-orchestrator-agent' to '@test-orchestrator-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'documentation-agent' to '@documentation-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'security-auditor-agent' to '@security-auditor-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'devops-agent' to '@devops-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'shadcn-ui-expert-agent' to '@shadcn-ui-expert-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'system-architect-agent' to '@system-architect-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'performance-load-tester-agent' to '@performance-load-tester-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'code-reviewer-agent' to '@code-reviewer-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Resolved legacy assignee 'debugger-agent' to '@debugger-agent'
2025-09-23 05:42:42,151 - fastmcp.task_management.interface.mcp_controllers.task_mcp_controller.handlers.crud_handler - INFO - Validated 10 assignees for task creation: ['@coding-agent', '@test-orchestrator-agent', '@documentation-agent', '@security-auditor-agent', '@devops-agent', '@shadcn-ui-expert-agent', '@system-architect-agent', '@performance-load-tester-agent', '@code-reviewer-agent', '@debugger-agent']
PASSED
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_list_tasks_filters_by_branch_a 2025-09-23 05:42:42,152 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

📦 Using sqlite test database
📊 DATABASE_TYPE: sqlite
🔗 MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - 📦 Using SQLite database for test execution
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /tmp/agenthub_test.db
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 SQLite mode for test execution
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,153 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Creating SQLite engine for test execution
2025-09-23 05:42:42,154 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ SQLite engine created for tests
2025-09-23 05:42:42,157 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Connected to SQLite: 3.45.1
2025-09-23 05:42:42,157 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,158 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table tasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,158 - fastmcp.task_management.infrastructure.database.ensure_ai_columns - WARNING - Table subtasks does not exist yet. Will be created by ORM.
2025-09-23 05:42:42,158 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified in database
2025-09-23 05:42:42,158 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-23 05:42:42,158 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-23 05:42:42,167 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-23 05:42:42,167 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-23 05:42:42,169 - fastmcp.task_management.infrastructure.database.database_config - INFO - ✅ AI columns verified/created successfully
2025-09-23 05:42:42,169 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-23 05:42:42,169 - fastmcp.task_management.infrastructure.database.database_config - INFO - 📦 Using SQLite database for tests: /tmp/agenthub_test.db
2025-09-23 05:42:42,173 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Created migrations tracking table: applied_migrations
2025-09-23 05:42:42,174 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: branch_summaries_mv
2025-09-23 05:42:42,179 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: branch_summaries_mv
2025-09-23 05:42:42,180 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: project_summaries_mv
2025-09-23 05:42:42,183 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: project_summaries_mv
2025-09-23 05:42:42,184 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: websocket_indexes
2025-09-23 05:42:42,191 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: websocket_indexes
2025-09-23 05:42:42,192 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Running migration: cascade_indexes
2025-09-23 05:42:42,197 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Successfully applied migration: cascade_indexes
2025-09-23 05:42:42,197 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-23 05:42:42,198 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-23 05:42:42,198 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-23 05:42:42,198 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-23 05:42:42,198 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-23 05:42:42,198 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /tmp/agenthub_test.db
⚠️ Error initializing test data: (sqlite3.OperationalError) disk I/O error
[SQL: 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                ]
[parameters: ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 23, 3, 42, 42, 198701, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 23, 3, 42, 42, 198702, tzinfo=datetime.timezone.utc), '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-23 05:42:42,199 - fastmcp.task_management.infrastructure.repositories.global_context_repository - INFO - GlobalContextRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
2025-09-23 05:42:42,199 - fastmcp.task_management.application.services.context_inheritance_service - INFO - ContextInheritanceService initialized
2025-09-23 05:42:42,199 - fastmcp.task_management.application.services.context_delegation_service - INFO - ContextDelegationService initialized
2025-09-23 05:42:42,199 - fastmcp.task_management.infrastructure.repositories.global_context_repository - INFO - GlobalContextRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
2025-09-23 05:42:42,199 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=c81d46f1-a698-551d-8598-904b925ae034, project=None, branch=None
2025-09-23 05:42:42,199 - fastmcp.task_management.infrastructure.repositories.repository_factory - WARNING - SQLiteGitBranchRepository not available, falling back to ORM
2025-09-23 05:42:42,200 - fastmcp.task_management.infrastructure.repositories.orm.git_branch_repository - INFO - ORMGitBranchRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
2025-09-23 05:42:42,200 - fastmcp.task_management.infrastructure.repositories.repository_factory - INFO - [RepositoryFactory] Using ORMGitBranchRepository (fallback)
2025-09-23 05:42:42,229 - fastmcp.task_management.infrastructure.repositories.repository_factory - INFO - [RepositoryFactory] Wrapping with CachedGitBranchRepository
2025-09-23 05:42:42,229 - fastmcp.task_management.infrastructure.repositories.cached.cached_git_branch_repository - WARNING - [CachedGitBranchRepository] Redis not available, caching disabled: Error 111 connecting to localhost:6379. Connection refused.
2025-09-23 05:42:42,229 - fastmcp.task_management.infrastructure.repositories.git_branch_repository_factory - INFO - Created git branch repository: orm for user: c81d46f1-a698-551d-8598-904b925ae034
2025-09-23 05:42:42,229 - fastmcp.task_management.application.facades.unified_context_facade - INFO - UnifiedContextFacade initialized for user=None, project=None, branch=None
2025-09-23 05:42:42,231 - git_branch_filtering_integration_test - ERROR - Failed to create project and branches: (sqlite3.OperationalError) disk I/O error
[SQL: INSERT INTO projects (id, name, description, user_id, status, metadata) VALUES (?, ?, ?, ?, ?, ?) RETURNING created_at, updated_at]
[parameters: ('3e76547f-2ad7-4d8a-9831-2cfc919b5035', 'Test Project 3e76547f', 'Integration test project', 'test-user-integration', 'active', '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR
🧹 Performing final test data cleanup...
🧹 Final cleanup completed:
   - 0 test data files removed
   - 0 temporary directories removed
✅ Test environment is clean


==================================== ERRORS ====================================
_ ERROR at setup of TestGitBranchFilteringIntegration.test_list_tasks_filters_by_branch_a _
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
    self.dialect.do_execute(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py:943: in do_execute
    cursor.execute(statement, parameters)
E   sqlite3.OperationalError: disk I/O error

The above exception was the direct cause of the following exception:
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py:49: in setup_method
    self._create_project_and_branches()
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py:92: in _create_project_and_branches
    session.commit()
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2032: in commit
    trans.commit(_to_root=True)
<string>:2: in commit
    ???
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1313: in commit
    self._prepare_impl()
<string>:2: in _prepare_impl
    ???
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
    self.session.flush()
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4345: in flush
    self._flush(objects)
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4480: in _flush
    with util.safe_reraise():
../../../.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py:4441: in _flush
    flush_context.execute()
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
    rec.execute(self)
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
    util.preloaded.orm_persistence.save_obj(
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
    _emit_insert_statements(
../../../.local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
    result = connection.execute(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1415: in execute
    return meth(
../../../.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
    return connection._execute_clauseelement(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
    ret = self._execute_context(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
    return self._exec_single_context(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
    self._handle_dbapi_exception(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
    self.dialect.do_execute(
../../../.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py:943: in do_execute
    cursor.execute(statement, parameters)
E   sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) disk I/O error
E   [SQL: INSERT INTO projects (id, name, description, user_id, status, metadata) VALUES (?, ?, ?, ?, ?, ?) RETURNING created_at, updated_at]
E   [parameters: ('3e76547f-2ad7-4d8a-9831-2cfc919b5035', 'Test Project 3e76547f', 'Integration test project', 'test-user-integration', 'active', '{}')]
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:495 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:495 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 📦 Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:128 Database path set from MCP_DB_PATH: /tmp/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /tmp/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:182 📦 SQLite mode for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:200 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:272 📦 Using SQLite database for tests: /tmp/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:310 📦 Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:328 ✅ SQLite engine created for tests
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:400 📦 Connected to SQLite: 3.45.1
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:437 Ensuring AI columns exist in database...
WARNING  fastmcp.task_management.infrastructure.database.ensure_ai_columns:ensure_ai_columns.py:48 Table tasks does not exist yet. Will be created by ORM.
WARNING  fastmcp.task_management.infrastructure.database.ensure_ai_columns:ensure_ai_columns.py:48 Table subtasks does not exist yet. Will be created by ORM.
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:439 ✅ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:37 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:473 Creating database tables...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:475 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:479 Ensuring AI columns exist in database...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:481 ✅ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:44 Running automatic database migrations...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:272 📦 Using SQLite database for tests: /tmp/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:84 Created migrations tracking table: applied_migrations
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:124 Running migration: branch_summaries_mv
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:127 Successfully applied migration: branch_summaries_mv
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:124 Running migration: project_summaries_mv
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:127 Successfully applied migration: project_summaries_mv
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:124 Running migration: websocket_indexes
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:127 Successfully applied migration: websocket_indexes
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:124 Running migration: cascade_indexes
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:127 Successfully applied migration: cascade_indexes
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:32 Database migration check completed
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:502 Database initialization completed
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:120 Migration runner completed successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:46 Automatic migrations completed successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:52 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /tmp/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.repositories.global_context_repository:global_context_repository.py:48 GlobalContextRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
INFO     fastmcp.task_management.application.services.context_inheritance_service:context_inheritance_service.py:29 ContextInheritanceService initialized
INFO     fastmcp.task_management.application.services.context_delegation_service:context_delegation_service.py:51 ContextDelegationService initialized
INFO     fastmcp.task_management.infrastructure.repositories.global_context_repository:global_context_repository.py:48 GlobalContextRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
INFO     fastmcp.task_management.application.facades.unified_context_facade:unified_context_facade.py:49 UnifiedContextFacade initialized for user=c81d46f1-a698-551d-8598-904b925ae034, project=None, branch=None
WARNING  fastmcp.task_management.infrastructure.repositories.repository_factory:repository_factory.py:162 SQLiteGitBranchRepository not available, falling back to ORM
INFO     fastmcp.task_management.infrastructure.repositories.orm.git_branch_repository:git_branch_repository.py:49 ORMGitBranchRepository initialized for user: c81d46f1-a698-551d-8598-904b925ae034
INFO     fastmcp.task_management.infrastructure.repositories.repository_factory:repository_factory.py:182 [RepositoryFactory] Using ORMGitBranchRepository (fallback)
INFO     fastmcp.task_management.infrastructure.repositories.repository_factory:repository_factory.py:188 [RepositoryFactory] Wrapping with CachedGitBranchRepository
WARNING  fastmcp.task_management.infrastructure.repositories.cached.cached_git_branch_repository:cached_git_branch_repository.py:51 [CachedGitBranchRepository] Redis not available, caching disabled: Error 111 connecting to localhost:6379. Connection refused.
INFO     fastmcp.task_management.infrastructure.repositories.git_branch_repository_factory:git_branch_repository_factory.py:66 Created git branch repository: orm for user: c81d46f1-a698-551d-8598-904b925ae034
INFO     fastmcp.task_management.application.facades.unified_context_facade:unified_context_facade.py:49 UnifiedContextFacade initialized for user=None, project=None, branch=None
ERROR    git_branch_filtering_integration_test:git_branch_filtering_integration_test.py:100 Failed to create project and branches: (sqlite3.OperationalError) disk I/O error
[SQL: INSERT INTO projects (id, name, description, user_id, status, metadata) VALUES (?, ?, ?, ?, ?, ?) RETURNING created_at, updated_at]
[parameters: ('3e76547f-2ad7-4d8a-9831-2cfc919b5035', 'Test Project 3e76547f', 'Integration test project', 'test-user-integration', 'active', '{}')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
=============================== warnings summary ===============================
src/tests/conftest.py:259
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:259: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: integration/test_bulk_api.py)
    class MockFastAPIClient:

../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
  /home/daihungpham/.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.11/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(

src/tests/conftest.py:259
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:259: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: integration/test_websocket_server.py)
    class MockFastAPIClient:

integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_task_with_mixed_valid_invalid_assignees
  /home/daihungpham/.local/lib/python3.12/site-packages/aiosqlite/core.py:112: RuntimeWarning: coroutine 'TaskApplicationFacade._derive_context_from_git_branch_id' was never awaited
    async def _execute(self, fn, *args, **kwargs):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_task_with_mixed_valid_invalid_assignees
  /home/daihungpham/.local/lib/python3.12/site-packages/aiosqlite/core.py:112: RuntimeWarning: coroutine 'TaskContextSyncService.sync_context_and_get_task' was never awaited
    async def _execute(self, fn, *args, **kwargs):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_list_tasks_filters_by_branch_a
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
=================== 12 passed, 11 warnings, 1 error in 1.89s ===================
