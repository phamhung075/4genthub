
üß™ Starting agenthub Test Suite
üõ°Ô∏è  Test data isolation enabled
üßπ Automatic cleanup configured
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.1, pluggy-1.6.0
rootdir: /home/daihungpham/__projects__/4genthub/agenthub_main
configfile: pyproject.toml
testpaths: src/tests, src/**/task_management/**/__tests__
plugins: postgresql-7.0.2, cov-6.2.1, anyio-4.9.0, asyncio-1.0.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collected 7000 items / 6 skipped

src/tests/ai_task_planning/application/services/ai_planning_service_test.py . [  0%]
................                                                         [  0%]
src/tests/ai_task_planning/application/test_application_init.py ..       [  0%]
src/tests/ai_task_planning/domain/entities/planning_request_test.py .... [  0%]
.........                                                                [  0%]
src/tests/ai_task_planning/domain/entities/task_plan_test.py ........... [  0%]
.............                                                            [  0%]
src/tests/ai_task_planning/domain/services/requirement_analyzer_test.py . [  0%]
................                                                         [  1%]
src/tests/ai_task_planning/domain/services/test_services_init.py ..      [  1%]
src/tests/ai_task_planning/domain/test_domain_init.py ..                 [  1%]
src/tests/ai_task_planning/interface/controllers/ai_planning_mcp_controller_test.py . [  1%]
..............................                                           [  1%]
src/tests/ai_task_planning/interface/test_interface_init.py ..           [  1%]
src/tests/ai_task_planning/test_ai_planning_init.py ..                   [  1%]
src/tests/auth/dependencies_test.py ...............                      [  1%]
src/tests/auth/hook_auth_test.py ..............................          [  2%]
src/tests/auth/infrastructure/repositories/email_token_repository_test.py . [  2%]
.....................................                                    [  2%]
src/tests/auth/interface/auth_endpoints_test.py ........................ [  3%]
.....................                                                    [  3%]
src/tests/auth/keycloak_dependencies_test.py ......................      [  3%]
src/tests/auth/keycloak_integration_test.py ............................ [  4%]
......                                                                   [  4%]
src/tests/auth/mcp_dependencies_test.py ....................             [  4%]
src/tests/auth/mcp_integration/test_database_connection_analysis.py .... [  4%]
.                                                                        [  4%]
src/tests/auth/mcp_integration/test_supabase_connection_fix.py ......    [  4%]
src/tests/auth/mcp_keycloak_auth_test.py ............................... [  5%]
...                                                                      [  5%]
src/tests/auth/middleware/request_context_middleware_test.py ........... [  5%]
........                                                                 [  5%]
src/tests/auth/models/api_token_test.py ........................         [  5%]
src/tests/auth/service_account_test.py ................................. [  6%]
.....                                                                    [  6%]
src/tests/connection_management/interface/controllers/connection_mcp_controller_test.py . [  6%]
............                                                             [  6%]
src/tests/connection_management/test_secure_health_check.py ....         [  6%]
src/tests/e2e/test_subtask_dialog_flow.py ssssss                         [  6%]
src/tests/hooks/test_agent_state_manager.py ............................ [  7%]
                                                                         [  7%]
src/tests/hooks/test_context_utilities_simple.py ..................      [  7%]
src/tests/hooks/test_hook_e2e.py ..........                              [  7%]
src/tests/hooks/test_hook_integration.py ............                    [  7%]
src/tests/hooks/test_hook_integration_simple.py ..........               [  7%]
src/tests/hooks/test_hook_system_comprehensive.py ...................... [  8%]
..                                                                       [  8%]
src/tests/hooks/test_hooks_basic.py ......                               [  8%]
src/tests/hooks/test_session_tracker.py ......................           [  8%]
src/tests/integration/agent_assignment_flow_test.py ............         [  8%]
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py . [  8%]
....                                                                     [  8%]
src/tests/integration/task_management/interface/git_branch_zero_tasks_deletion_integration_test.py . [  8%]
......                                                                   [  8%]
src/tests/integration/task_management/test_critical_fixes_verification.py . [  8%]
..                                                                       [  8%]
src/tests/integration/task_management/test_subtask_user_id_fix.py ...    [  8%]
src/tests/integration/test_assignees_fix.py ..                           [  8%]
src/tests/integration/test_auth_websocket_integration.py ........        [  9%]
src/tests/integration/test_bulk_api.py ssssss                            [  9%]
src/tests/integration/test_direct_task_creation.py .                     [  9%]
src/tests/integration/test_docker_config.py ................             [  9%]
src/tests/integration/test_id_validation_api_flows.py ....               [  9%]
src/tests/integration/test_manual_task_creation.py .                     [  9%]
src/tests/integration/test_mcp_authentication_fixes.py .....             [  9%]
src/tests/integration/test_mcp_tools_inclusion.py .                      [  9%]
src/tests/integration/test_selective_field_queries.py .............      [  9%]
src/tests/integration/test_service_account_auth.py .............F
üßπ Performing final test data cleanup...
üßπ Final cleanup completed:
   - 0 test data files removed
   - 0 temporary directories removed
‚úÖ Test environment is clean


=================================== FAILURES ===================================
________________ TestServiceAccountAuth.test_singleton_instance ________________
src/tests/integration/test_service_account_auth.py:327: in test_singleton_instance
    await auth1.close()
src/fastmcp/auth/service_account.py:390: in close
    await self.client.aclose()
E   TypeError: object MagicMock can't be used in 'await' expression
---------------------------- Captured stdout setup -----------------------------
2025-09-24 03:25:10,088 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - DatabaseSourceManager singleton cleared
2025-09-24 03:25:10,088 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed
2025-09-24 03:25:10,088 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database connections closed

üì¶ Using sqlite test database
üìä DATABASE_TYPE: sqlite
üîó DATABASE_PATH: :memory:
2025-09-24 03:25:10,088 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - üì¶ Using SQLite database for test execution
2025-09-24 03:25:10,088 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Detected TEST mode (pytest)
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_source_manager - INFO - Database path set to: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Initializing database: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ SQLite mode enabled for development/testing
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database type: sqlite
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database: /home/daihungpham/__projects__/4genthub/agenthub_main/:memory:
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Creating SQLite engine for test execution
2025-09-24 03:25:10,089 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ SQLite engine created for tests
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine SELECT sqlite_version()
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - SELECT sqlite_version()
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine [generated in 0.00012s] ()
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-09-24 03:25:10,090 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Connected to SQLite: 3.45.1
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,090 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo("tasks")
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_xinfo("tasks")
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,090 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo("subtasks")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_xinfo("subtasks")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine COMMIT
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-24 03:25:10,091 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified in database
2025-09-24 03:25:10,091 - fastmcp.task_management.infrastructure.database.init_database - INFO - Initializing database: sqlite
2025-09-24 03:25:10,091 - fastmcp.task_management.infrastructure.database.database_config - INFO - Creating database tables...
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("api_tokens")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("api_tokens")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("projects")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("projects")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("project_git_branchs")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("project_git_branchs")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("tasks")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("tasks")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("subtasks")
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subtasks")
2025-09-24 03:25:10,091 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,091 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("task_assignees")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("task_assignees")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("task_dependencies")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("task_dependencies")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("agents")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("agents")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("labels")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("labels")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("task_labels")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("task_labels")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("templates")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("templates")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("global_contexts")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("global_contexts")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("project_contexts")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("project_contexts")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("branch_contexts")
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("branch_contexts")
2025-09-24 03:25:10,092 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,092 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("task_contexts")
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("task_contexts")
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("context_delegations")
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("context_delegations")
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("context_inheritance_cache")
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("context_inheritance_cache")
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("users")
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user_sessions")
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("user_sessions")
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine COMMIT
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-24 03:25:10,093 - fastmcp.task_management.infrastructure.database.database_config - INFO - Database tables created successfully
2025-09-24 03:25:10,093 - fastmcp.task_management.infrastructure.database.database_config - INFO - Ensuring AI columns exist in database...
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
2025-09-24 03:25:10,093 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,093 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo("tasks")
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_xinfo("tasks")
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo("subtasks")
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_xinfo("subtasks")
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine ROLLBACK
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-09-24 03:25:10,094 INFO sqlalchemy.engine.Engine COMMIT
2025-09-24 03:25:10,094 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-09-24 03:25:10,094 - fastmcp.task_management.infrastructure.database.database_config - INFO - ‚úÖ AI columns verified/created successfully
2025-09-24 03:25:10,094 - fastmcp.task_management.infrastructure.database.init_database - INFO - Running automatic database migrations...
2025-09-24 03:25:10,095 - fastmcp.task_management.infrastructure.database.database_config - INFO - üì¶ Using SQLite database: /home/daihungpham/__projects__/4genthub/agenthub_main/:memory:
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database migration check completed
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.migration_runner - INFO - Database initialization completed
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.init_database - INFO - Migration runner completed successfully
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.init_database - INFO - Automatic migrations completed successfully
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.init_database - INFO - Database initialization completed successfully
2025-09-24 03:25:10,100 - fastmcp.task_management.infrastructure.database.database_initializer - INFO - Database initialized successfully: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
2025-09-24 03:25:10,100 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-09-24 03:25:10,100 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-09-24 03:25:10,100 INFO sqlalchemy.engine.Engine SELECT 1
2025-09-24 03:25:10,100 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-09-24 03:25:10,100 INFO sqlalchemy.engine.Engine [generated in 0.00006s] ()
2025-09-24 03:25:10,100 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-09-24 03:25:10,100 INFO sqlalchemy.engine.Engine 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
2025-09-24 03:25:10,100 - sqlalchemy.engine.Engine - INFO - 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
2025-09-24 03:25:10,101 INFO sqlalchemy.engine.Engine [generated in 0.00008s] ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 24, 1, 25, 10, 100830, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 100831, tzinfo=datetime.timezone.utc), '{}')
2025-09-24 03:25:10,101 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 24, 1, 25, 10, 100830, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 100831, tzinfo=datetime.timezone.utc), '{}')
2025-09-24 03:25:10,101 INFO sqlalchemy.engine.Engine 
                    INSERT INTO project_git_branchs (id, project_id, name, description, created_at, updated_at, priority, status, metadata, task_count, completed_task_count, user_id) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
2025-09-24 03:25:10,101 - sqlalchemy.engine.Engine - INFO - 
                    INSERT INTO project_git_branchs (id, project_id, name, description, created_at, updated_at, priority, status, metadata, task_count, completed_task_count, user_id) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
2025-09-24 03:25:10,101 INFO sqlalchemy.engine.Engine [generated in 0.00009s] ('ca49c299-93ed-4793-b8ee-73f0e70babf1', 'default_project', 'main', 'Main branch for testing', datetime.datetime(2025, 9, 24, 1, 25, 10, 101168, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 101169, tzinfo=datetime.timezone.utc), 'medium', 'todo', '{}', 0, 0, 'system')
2025-09-24 03:25:10,101 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ('ca49c299-93ed-4793-b8ee-73f0e70babf1', 'default_project', 'main', 'Main branch for testing', datetime.datetime(2025, 9, 24, 1, 25, 10, 101168, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 101169, tzinfo=datetime.timezone.utc), 'medium', 'todo', '{}', 0, 0, 'system')
2025-09-24 03:25:10,101 INFO sqlalchemy.engine.Engine COMMIT
2025-09-24 03:25:10,101 - sqlalchemy.engine.Engine - INFO - COMMIT
üì¶ Initialized PostgreSQL test database with basic test data (branch_id: ca49c299-93ed-4793-b8ee-73f0e70babf1)
2025-09-24 03:25:10,115 - fastmcp.auth.service_account - INFO - ‚úÖ Service account auth initialized for client: test-service-account
------------------------------ Captured log setup ------------------------------
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:260 DatabaseSourceManager singleton cleared
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:544 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:544 Database connections closed
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:91 üì¶ Using SQLite database for test execution
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:73 Detected TEST mode (pytest)
INFO     fastmcp.task_management.infrastructure.database.database_source_manager:database_source_manager.py:163 Database path set to: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:110 Initializing database: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:200 üì¶ SQLite mode enabled for development/testing
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:218 Database type: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:307 üì¶ Using SQLite database: /home/daihungpham/__projects__/4genthub/agenthub_main/:memory:
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:345 üì¶ Creating SQLite engine for test execution
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:363 ‚úÖ SQLite engine created for tests
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT sqlite_version()
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00012s] ()
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:440 üì¶ Connected to SQLite: 3.45.1
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:477 Ensuring AI columns exist in database...
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_xinfo("tasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_xinfo("subtasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:479 ‚úÖ AI columns verified in database
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:37 Initializing database: sqlite
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:522 Creating database tables...
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("api_tokens")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("projects")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("project_git_branchs")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("tasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("subtasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("task_assignees")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("task_dependencies")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("agents")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("labels")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("task_labels")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("templates")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("global_contexts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("project_contexts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("branch_contexts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("task_contexts")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("context_delegations")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("context_inheritance_cache")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("users")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_info("user_sessions")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:524 Database tables created successfully
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:528 Ensuring AI columns exist in database...
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite~_%' ESCAPE '~' ORDER BY name
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_xinfo("tasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 PRAGMA main.table_xinfo("subtasks")
INFO     sqlalchemy.engine.Engine:base.py:1842 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2701 ROLLBACK
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:530 ‚úÖ AI columns verified/created successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:44 Running automatic database migrations...
INFO     fastmcp.task_management.infrastructure.database.database_config:database_config.py:307 üì¶ Using SQLite database: /home/daihungpham/__projects__/4genthub/agenthub_main/:memory:
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:32 Database migration check completed
INFO     fastmcp.task_management.infrastructure.database.migration_runner:migration_runner.py:502 Database initialization completed
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:120 Migration runner completed successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:46 Automatic migrations completed successfully
INFO     fastmcp.task_management.infrastructure.database.init_database:init_database.py:52 Database initialization completed successfully
INFO     fastmcp.task_management.infrastructure.database.database_initializer:database_initializer.py:118 Database initialized successfully: /home/daihungpham/__projects__/4genthub/agenthub_main/database/data/agenthub_test.db
INFO     sqlalchemy.engine.Engine:base.py:2698 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1842 SELECT 1
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00006s] ()
INFO     sqlalchemy.engine.Engine:base.py:1842 
                    INSERT INTO projects (id, name, description, user_id, status, created_at, updated_at, metadata) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET 
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00008s] ('default_project', 'Default Test Project', 'Project for testing', 'default_id', 'active', datetime.datetime(2025, 9, 24, 1, 25, 10, 100830, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 100831, tzinfo=datetime.timezone.utc), '{}')
INFO     sqlalchemy.engine.Engine:base.py:1842 
                    INSERT INTO project_git_branchs (id, project_id, name, description, created_at, updated_at, priority, status, metadata, task_count, completed_task_count, user_id) 
                    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                    ON CONFLICT (id) DO UPDATE SET
                        name = EXCLUDED.name,
                        description = EXCLUDED.description,
                        updated_at = EXCLUDED.updated_at
                
INFO     sqlalchemy.engine.Engine:base.py:1842 [generated in 0.00009s] ('ca49c299-93ed-4793-b8ee-73f0e70babf1', 'default_project', 'main', 'Main branch for testing', datetime.datetime(2025, 9, 24, 1, 25, 10, 101168, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 9, 24, 1, 25, 10, 101169, tzinfo=datetime.timezone.utc), 'medium', 'todo', '{}', 0, 0, 'system')
INFO     sqlalchemy.engine.Engine:base.py:2704 COMMIT
INFO     fastmcp.auth.service_account:service_account.py:108 ‚úÖ Service account auth initialized for client: test-service-account
=============================== warnings summary ===============================
src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/auth/interface/auth_endpoints_test.py)
    class MockFastAPIClient:

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/integration/test_bulk_api.py)
    class MockFastAPIClient:

../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
../../../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298
  /home/daihungpham/.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:298: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.11/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/integration/test_websocket_server.py)
    class MockFastAPIClient:

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/security/websocket/test_websocket_integration.py)
    class MockFastAPIClient:

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/security/websocket/test_websocket_security.py)
    class MockFastAPIClient:

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/task_management/infrastructure/monitoring/metrics_integration_test.py)
    class MockFastAPIClient:

src/tests/conftest.py:264
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/tests/conftest.py:264: PytestCollectionWarning: cannot collect test class 'MockFastAPIClient' because it has a __init__ constructor (from: src/tests/unit/auth/interface/auth_endpoints_test.py)
    class MockFastAPIClient:

src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_subtask_inheritance_service_failure
  /home/daihungpham/.local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py:3809: RuntimeWarning: coroutine 'TaskApplicationFacade._derive_context_from_git_branch_id' was never awaited
    ckbm[cb].append(bindparam)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

src/tests/integration/agent_assignment_flow_test.py::TestEdgeCasesAndErrorHandling::test_create_subtask_inheritance_service_failure
  /home/daihungpham/.local/lib/python3.12/site-packages/sqlalchemy/sql/compiler.py:3809: RuntimeWarning: coroutine 'TaskContextSyncService.sync_context_and_get_task' was never awaited
    ckbm[cb].append(bindparam)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_list_tasks_filters_by_branch_a
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_list_tasks_filters_by_branch_b
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_list_tasks_without_filter_returns_all_tasks
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_optimized_repository_direct_filtering
src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_optimized_repository_parameter_override
  /home/daihungpham/__projects__/4genthub/agenthub_main/src/fastmcp/task_management/application/services/websocket_notification_service.py:608: RuntimeWarning: coroutine 'broadcast_data_change' was never awaited
    new_loop.close()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_optimized_repository_parameter_override
  /home/daihungpham/.local/lib/python3.12/site-packages/sqlalchemy/orm/loading.py:811: RuntimeWarning: coroutine 'TaskApplicationFacade._derive_context_from_git_branch_id' was never awaited
    def _instance_processor(
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

src/tests/integration/task_management/interface/git_branch_filtering_integration_test.py::TestGitBranchFilteringIntegration::test_optimized_repository_parameter_override
  /home/daihungpham/.local/lib/python3.12/site-packages/sqlalchemy/orm/loading.py:811: RuntimeWarning: coroutine 'TaskContextSyncService.sync_context_and_get_task' was never awaited
    def _instance_processor(
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

src/tests/integration/test_mcp_tools_inclusion.py::test_mcp_tools_inclusion
  /home/daihungpham/.local/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but src/tests/integration/test_mcp_tools_inclusion.py::test_mcp_tools_inclusion returned <class 'dict'>.
  Did you mean to use `assert` instead of `return`?
  See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
    warnings.warn(

src/tests/integration/test_service_account_auth.py: 14 warnings
  /home/daihungpham/.local/lib/python3.12/site-packages/_pytest/python.py:722: RuntimeWarning: coroutine 'TestServiceAccountAuth.teardown_method' was never awaited
    func()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================= slowest 10 durations =============================
16.54s call     src/tests/integration/test_docker_config.py::TestCapRoverPostgreSQLConnection::test_caprover_postgres_docker_compose_configuration
3.23s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[Debug-debug]
3.23s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[ERROR-error]
3.23s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[INFO-info]
3.23s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[info-info]
3.18s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[DEBUG-debug]
3.18s call     src/tests/integration/test_docker_config.py::TestUvicornStartupValidation::test_uvicorn_log_level_case_conversion[WARNING-warning]
3.04s call     src/tests/hooks/test_hook_integration.py::TestHookChainIntegration::test_documentation_workflow_integration
1.09s call     src/tests/integration/test_docker_config.py::TestErrorScenarios::test_docker_entrypoint_weak_jwt_secret
1.01s call     src/tests/integration/test_service_account_auth.py::TestServiceAccountAuth::test_force_refresh
=========================== short test summary info ============================
SKIPPED [1] src/tests/hooks/test_context_injector.py:40: context_injector module not available
SKIPPED [1] src/tests/hooks/test_context_management_integration.py:45: context management modules not available
SKIPPED [1] src/tests/hooks/test_context_synchronizer.py:41: context_synchronizer module not available
SKIPPED [1] src/tests/hooks/test_role_enforcer.py:39: role_enforcer module not available
SKIPPED [1] src/tests/hooks/test_session_state_integration.py:60: session/state management modules not available
SKIPPED [1] src/tests/hooks/test_state_persistence.py:59: state persistence modules not available
SKIPPED [6] src/tests/e2e/test_subtask_dialog_flow.py: Playwright E2E tests require pytest-playwright. Install with: pip install pytest-playwright && playwright install
SKIPPED [6] src/tests/integration/test_bulk_api.py: Tests require database and auth setup not available in test environment
FAILED src/tests/integration/test_service_account_auth.py::TestServiceAccountAuth::test_singleton_instance
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
====== 1 failed, 683 passed, 18 skipped, 38 warnings in 63.75s (0:01:03) =======
